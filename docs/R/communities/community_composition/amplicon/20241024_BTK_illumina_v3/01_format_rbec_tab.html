<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Milla Similä &amp; Shane Hogle">
<meta name="dcterms.date" content="2025-07-04">

<title>Formatting Rbec output from 2024-10-20 sequenced by BTK Turku using custom HAMBI Illumina v3 primers – hambiEvoEnvCoexist</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap-1f23bf93a17969024013c136d185e5ce.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../R/communities/community_composition/amplicon/20240711_BTK_illumina_v3/01_format_rbec_tab.html">4. Community growth - amplicon formatting</a></li><li class="breadcrumb-item"><a href="../../../../../R/communities/community_composition/amplicon/20241024_BTK_illumina_v3/01_format_rbec_tab.html">iii) Batch 2024-10-24</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../../../">hambiEvoEnvCoexist</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">1. Monoculture growth</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/monocultures/bioscreen/01_format_growthcurves_batch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Inspect and format growth curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/monocultures/bioscreen/02_plot_analyze_growth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ii) Plot growth summaries</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">2. Community growth - experiment design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/experiment_design/01_pairs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Species pairs - 96 Well plate layout</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/experiment_design/02_trios.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ii) Species trios - 96 Well plate layout</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/experiment_design/03_quartets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">iii) Species quartets - 96 Well plate layout</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">3. Community growth - biomass</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_biomass/optical_density/01_format_plot_od.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Process and plot OD data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">4. Community growth - amplicon formatting</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_composition/amplicon/20240711_BTK_illumina_v3/01_format_rbec_tab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Batch 2024-07-11</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_composition/amplicon/20241024_BTK_illumina_v3/01_format_rbec_tab.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">iii) Batch 2024-10-24</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_composition/amplicon/20250127_BTK_illumina_v3/01_format_rbec_tab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">iv) Batch 2025-01-27</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_composition/amplicon/20250502_BTK_illumina_v3/01_format_rbec_tab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">v) Batch 2025-05-02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_composition/amplicon/01_compile_format.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">vi) Compile pairs, trios, quartets</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">5. Community growth - composition</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_composition/01_analysis_pairs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Species pairs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_composition/02_analysis_trios.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ii) Species trios</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_composition/03_analysis_quartets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">iii) Species quartets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_composition/04_analysis_octets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">iv) All strains combined</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../R/communities/community_composition/05_assembly_rule_violation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">v) Violation of pairwise assembly rule</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup"><span class="header-section-number">1</span> Setup</a>
  <ul class="collapse">
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><span class="header-section-number">1.1</span> Libraries</a></li>
  <li><a href="#global-variables" id="toc-global-variables" class="nav-link" data-scroll-target="#global-variables"><span class="header-section-number">1.2</span> Global variables</a></li>
  </ul></li>
  <li><a href="#read-metadata" id="toc-read-metadata" class="nav-link" data-scroll-target="#read-metadata"><span class="header-section-number">2</span> Read metadata</a></li>
  <li><a href="#read-rbec-raw-counts-tables" id="toc-read-rbec-raw-counts-tables" class="nav-link" data-scroll-target="#read-rbec-raw-counts-tables"><span class="header-section-number">3</span> Read Rbec raw counts tables</a>
  <ul class="collapse">
  <li><a href="#untar-rbec-output-tarball" id="toc-untar-rbec-output-tarball" class="nav-link" data-scroll-target="#untar-rbec-output-tarball"><span class="header-section-number">3.1</span> Untar Rbec output tarball</a></li>
  <li><a href="#setup-directory-structure" id="toc-setup-directory-structure" class="nav-link" data-scroll-target="#setup-directory-structure"><span class="header-section-number">3.2</span> Setup directory structure</a></li>
  <li><a href="#read" id="toc-read" class="nav-link" data-scroll-target="#read"><span class="header-section-number">3.3</span> Read</a></li>
  <li><a href="#clean-up" id="toc-clean-up" class="nav-link" data-scroll-target="#clean-up"><span class="header-section-number">3.4</span> Clean up</a></li>
  </ul></li>
  <li><a href="#format" id="toc-format" class="nav-link" data-scroll-target="#format"><span class="header-section-number">4</span> Format</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span class="header-section-number">5</span> Analysis</a>
  <ul class="collapse">
  <li><a href="#negative-controls" id="toc-negative-controls" class="nav-link" data-scroll-target="#negative-controls"><span class="header-section-number">5.1</span> Negative controls</a></li>
  <li><a href="#positive-controls" id="toc-positive-controls" class="nav-link" data-scroll-target="#positive-controls"><span class="header-section-number">5.2</span> Positive controls</a></li>
  <li><a href="#misassigned-reads" id="toc-misassigned-reads" class="nav-link" data-scroll-target="#misassigned-reads"><span class="header-section-number">5.3</span> Misassigned reads</a></li>
  <li><a href="#samples-with-few-total-reads" id="toc-samples-with-few-total-reads" class="nav-link" data-scroll-target="#samples-with-few-total-reads"><span class="header-section-number">5.4</span> Samples with few total reads</a></li>
  <li><a href="#filter-to-target-species" id="toc-filter-to-target-species" class="nav-link" data-scroll-target="#filter-to-target-species"><span class="header-section-number">5.5</span> Filter to target species</a></li>
  <li><a href="#masterplate-samples" id="toc-masterplate-samples" class="nav-link" data-scroll-target="#masterplate-samples"><span class="header-section-number">5.6</span> Masterplate samples</a>
  <ul class="collapse">
  <li><a href="#pairs" id="toc-pairs" class="nav-link" data-scroll-target="#pairs"><span class="header-section-number">5.6.1</span> Pairs</a></li>
  <li><a href="#trios" id="toc-trios" class="nav-link" data-scroll-target="#trios"><span class="header-section-number">5.6.2</span> Trios</a></li>
  <li><a href="#quartets" id="toc-quartets" class="nav-link" data-scroll-target="#quartets"><span class="header-section-number">5.6.3</span> Quartets</a></li>
  </ul></li>
  <li><a href="#experimental-samples" id="toc-experimental-samples" class="nav-link" data-scroll-target="#experimental-samples"><span class="header-section-number">5.7</span> Experimental samples</a>
  <ul class="collapse">
  <li><a href="#pairs-1" id="toc-pairs-1" class="nav-link" data-scroll-target="#pairs-1"><span class="header-section-number">5.7.1</span> Pairs</a></li>
  <li><a href="#trios-1" id="toc-trios-1" class="nav-link" data-scroll-target="#trios-1"><span class="header-section-number">5.7.2</span> Trios</a></li>
  <li><a href="#sec-quartets2" id="toc-sec-quartets2" class="nav-link" data-scroll-target="#sec-quartets2"><span class="header-section-number">5.7.3</span> Quartets</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#export" id="toc-export" class="nav-link" data-scroll-target="#export"><span class="header-section-number">6</span> Export</a>
  <ul class="collapse">
  <li><a href="#pairs-2" id="toc-pairs-2" class="nav-link" data-scroll-target="#pairs-2"><span class="header-section-number">6.1</span> Pairs</a></li>
  <li><a href="#trios-2" id="toc-trios-2" class="nav-link" data-scroll-target="#trios-2"><span class="header-section-number">6.2</span> Trios</a></li>
  <li><a href="#quartets-1" id="toc-quartets-1" class="nav-link" data-scroll-target="#quartets-1"><span class="header-section-number">6.3</span> Quartets</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../R/communities/community_composition/amplicon/20240711_BTK_illumina_v3/01_format_rbec_tab.html">4. Community growth - amplicon formatting</a></li><li class="breadcrumb-item"><a href="../../../../../R/communities/community_composition/amplicon/20241024_BTK_illumina_v3/01_format_rbec_tab.html">iii) Batch 2024-10-24</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Formatting Rbec output from 2024-10-20 sequenced by BTK Turku using custom HAMBI Illumina v3 primers</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Milla Similä &amp; Shane Hogle </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 4, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    Results from trios and quartets in 0 ug/ml streptomycin concentration and their masterplates from Milla’s community assembly experiment. Also includes a couple pairs that failed last time that we redid in this sequencing run.
  </div>
</div>


</header>


<section id="setup" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setup</h1>
<section id="libraries" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="libraries"><span class="header-section-number">1.1</span> Libraries</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(fs)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(archive)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils_generic.R"</span>))</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"communities"</span>, <span class="st">"community_composition"</span>, <span class="st">"amplicon"</span>, <span class="st">"utils_amplicon.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="global-variables" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="global-variables"><span class="header-section-number">1.2</span> Global variables</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>data_raw <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_data_raw"</span>, <span class="st">"communities"</span>, <span class="st">"20241024_BTK_illumina_v3"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>data <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"communities"</span>, <span class="st">"20241024_BTK_illumina_v3"</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>amplicontar <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(data_raw, <span class="st">"rbec_output.tar.gz"</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># make processed data directory if it doesn't exist</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(data)</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># create temporary location to decompress</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>tmpdir <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">file_temp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="read-metadata" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Read metadata</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mddf <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_raw, <span class="st">"20241024_BTK_illumina_v3_metadata.tsv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">str_trim</span>(sample))</span>
<span id="cb3-3"><a href="#cb3-3"></a>spdf <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_raw, <span class="st">"sample_compositions.tsv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">str_trim</span>(sample))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="read-rbec-raw-counts-tables" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Read Rbec raw counts tables</h1>
<section id="untar-rbec-output-tarball" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="untar-rbec-output-tarball"><span class="header-section-number">3.1</span> Untar Rbec output tarball</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>archive<span class="sc">::</span><span class="fu">archive_extract</span>(</span>
<span id="cb4-2"><a href="#cb4-2"></a>  amplicontar,</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="at">dir =</span> tmpdir,</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="at">files =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="at">options =</span> <span class="fu">character</span>(),</span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="at">strip_components =</span> <span class="dv">0</span>L</span>
<span id="cb4-7"><a href="#cb4-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="setup-directory-structure" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="setup-directory-structure"><span class="header-section-number">3.2</span> Setup directory structure</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>tabdir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(tmpdir, <span class="st">"rbec_output"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>samppaths <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(tabdir)</span>
<span id="cb5-3"><a href="#cb5-3"></a>sampnames <span class="ot">&lt;-</span> <span class="fu">path_split</span>(samppaths) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">map_chr</span>(dplyr<span class="sc">::</span>last)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="read" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="read"><span class="header-section-number">3.3</span> Read</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>straintabs <span class="ot">&lt;-</span> <span class="fu">paste0</span>(samppaths, <span class="st">"/strain_table.txt"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">set_names</span>(sampnames) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">map_df</span>(</span>
<span id="cb6-4"><a href="#cb6-4"></a>  read_tsv,</span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="at">skip =</span> <span class="dv">1</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"rRNA16S_locus"</span>,<span class="st">"count"</span>),</span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, </span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="at">.id =</span> <span class="st">"sample"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="clean-up" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="clean-up"><span class="header-section-number">3.4</span> Clean up</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># remove decompressed directory from temp location</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>fs<span class="sc">::</span><span class="fu">dir_delete</span>(tmpdir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="format" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Format</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>straintabs_norm <span class="ot">&lt;-</span> straintabs <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="co"># Calls function that normalize counts by 16S copy number</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">normalize_by_copy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="co"># Calls function that completes all combinations of 23 species</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="co"># this is important because some species go extinct that should be in the samples</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="co"># and we need to have those in the final table</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">complete_combos</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="co"># removes any extra whitespace on sample names</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">str_trim</span>(sample))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Make final table</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Later we will take advantage of the fact that for species not supposed to be</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co"># in a sample the prior left_join will have filled the evo_hist category with an</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># NA. We can then filter using this NA value</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>finaltable <span class="ot">&lt;-</span> <span class="fu">left_join</span>(straintabs_norm, mddf, <span class="at">by =</span> <span class="fu">join_by</span>(sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">left_join</span>(spdf, <span class="at">by =</span> <span class="fu">join_by</span>(sample, strainID)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="#cb9-7"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>genus, <span class="sc">-</span>species) <span class="sc">%&gt;%</span> </span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="fu">mutate</span>(<span class="at">f_raw =</span> count_correct<span class="sc">/</span><span class="fu">sum</span>(count_correct),</span>
<span id="cb9-9"><a href="#cb9-9"></a>         <span class="at">sample_tot_raw =</span> <span class="fu">sum</span>(count_correct)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="fu">relocate</span>(sample_tot_raw, f_raw, target_f, evo_hist, <span class="at">.after =</span> count_correct) <span class="sc">%&gt;%</span> </span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="co"># reformats sample names for pairs so that they are same as in the the batch from</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>  <span class="co"># 20240711</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">case_when</span>(n_species <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> notes, </span>
<span id="cb9-15"><a href="#cb9-15"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> sample))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="analysis" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Analysis</h1>
<p>Let’s quickly compare and look the at number of reads from the different kinds of experiment categories. Negative controls are samples from the experiment that contained growth medium but no cells. We included them to make sure that there was not contamination between wells during the experiment. Positive controls contain a mixsture of all 23 species (not sure why this was done), and some wells are just empty but were processed/sequenced anyway for convenience of the person preparing the libraries. Experiment samples are those that came from the actual experiment, and masterplate samples are the defined mixtures we made to inoculate the experiment. We sequenced these masterplates so that we would have T0 information for each experimental treatment.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, sample_tot_raw, community_type) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_tot_raw)) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="fu">aes</span>(<span class="at">fill =</span> community_type)) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> </span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"b"</span>, <span class="at">color=</span><span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Sample count"</span>, <span class="at">x =</span> <span class="st">"Total reads per sample"</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> community_type, <span class="at">scales=</span><span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Frequency distribution of total read counts per sample in the experimental samples (red) and the negative controls (blue).
</figcaption>
</figure>
</div>
<p>The smallest number of reads in the experimental samples is 8295 and the mean is 17337.13 which is considerably more than the smallest number of reads 452 and the mean 888.68 in the negative controls.</p>
<p>This looks really good. The number of reads in the negative controls are always very low (similar to “empty” samples and always an order of magnitude less than masterplates and experimental samples). The number of reads in the negative controls will depend on the sequencing depth used and in this batch compared to the first one with pairs we have used a higher sequencing depth (or less multiplexing) so that the average number of reads is higher here.</p>
<section id="negative-controls" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="negative-controls"><span class="header-section-number">5.1</span> Negative controls</h2>
<p>First, we’ll check whether the experimental and plate negative controls look good</p>
<p>Lets check what species are contaminating negative controls. Most appear to be low abundance contaminants of species excluded from the experiment. Probably this is cross talk from the positive controls and other samples</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"^neg"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">contam_histogram</span>(<span class="at">trans=</span><span class="cn">TRUE</span>, <span class="at">x =</span> f_raw) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Frequency distribution of each species in the negative controls"</span>, <span class="at">y =</span> <span class="st">"Sample count"</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>strainID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Frequency distribution of all species in the negative controls
</figcaption>
</figure>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"^neg"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(strainID, <span class="st">"0403|1287|1896|1977"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">contam_histogram</span>(<span class="at">trans=</span><span class="cn">TRUE</span>, <span class="at">x =</span> f_raw) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Frequency distribution of each species in the negative controls"</span>, <span class="at">y =</span> <span class="st">"Sample count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Frequency distribution of only target target species in the negative controls
</figcaption>
</figure>
</div>
<!-- Again, I think this is really good. Negative controls are strange to sequence because they have such low biomass usually and then weird things can happen with the PCRs in the library preparation stages. However, let’s make sure negative control samples have low OD600 in the endpoint samples. This would indicate growth and that what we are seeing in the histograms is truly just a sequencing artifact -->
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>od <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_data_raw"</span>, <span class="st">"communities"</span>, <span class="st">"optical_density"</span>, <span class="st">"20240829_tqs"</span>, <span class="st">"optical_density_formatted_102024.txt"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">mutate</span>(<span class="at">well =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(well,</span>
<span id="cb13-3"><a href="#cb13-3"></a>                     <span class="at">pattern =</span> <span class="st">"([0-9]+)"</span>, </span>
<span id="cb13-4"><a href="#cb13-4"></a>                     <span class="at">replacement =</span> {\(x) stringr<span class="sc">::</span><span class="fu">str_pad</span>(<span class="at">string =</span> x, <span class="at">width =</span> <span class="dv">2</span>,  <span class="at">side =</span> <span class="st">"left"</span>,  <span class="at">pad =</span> <span class="st">"0"</span>)}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>All negative control have very low OD &lt; 0.1 and it is safe to assume that they are clean.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(finaltable, od, <span class="at">by =</span> <span class="fu">join_by</span>(sample, transfers<span class="sc">==</span>transfer, replicate, strep_conc)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"^neg"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, OD, well, community_type, n_species.x, n_species.y, replicate) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(OD))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>All negative control have very low OD &lt; 0.1 and low read counts it is safe to assume that they are clean.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">left_join</span>(finaltable, <span class="at">by =</span> <span class="fu">join_by</span>(sample, community_type, replicate, n_species.x<span class="sc">==</span>n_species)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(strainID, <span class="st">"0403|1287|1896|1977"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_tot_raw, sample, OD, community_type) <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="sc">-</span>sample, <span class="sc">-</span>community_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">"free_x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-04" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Optical density (OD) and total read count distributions of negative controls.
</figcaption>
</figure>
</div>
</section>
<section id="positive-controls" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="positive-controls"><span class="header-section-number">5.2</span> Positive controls</h2>
<p>The positive community controls should each have all 23 species.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"^pos"</span>) <span class="sc">&amp;</span> count_correct <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">mutate</span>(<span class="at">n_sp_detected =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="fu">distinct</span>(sample, sample_tot_raw, n_sp_detected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sample"],"name":[1],"type":["chr"],"align":["left"]},{"label":["sample_tot_raw"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["n_sp_detected"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"4_p09_A01","2":"961","3":"4"},{"1":"4_p10_A01","2":"14930","3":"23"},{"1":"4m_p18_A01","2":"18660","3":"23"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>2/3 community controls have plenty of reads and look normal. One has under 1000 reads in total and it only contains the 4 focal species (0403, 1287, 1896, 1977). It looks to me that this could be a mislabeled negative control?</p>
</section>
<section id="misassigned-reads" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="misassigned-reads"><span class="header-section-number">5.3</span> Misassigned reads</h2>
<p>These libraries were only prepared with samples containing HAMBI_0403, HAMBI_1287, HAMBI_1896, and HAMBI_1977 so any time species other than these show up is just an incorrect assignment by Rbec or index leakage/crosstalk from the positive community controls. Let’s check quickly how many of these there are…</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="co"># filter out community controls since they have all hambi species</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"4_p09_A01"</span>, <span class="st">"4_p10_A01"</span>, <span class="st">"4m_p18_A01"</span> ))) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(strainID, <span class="st">"0403|1287|1896|1977"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="fu">filter</span>(count_correct <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count_correct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sample"],"name":[1],"type":["chr"],"align":["left"]},{"label":["strainID"],"name":[2],"type":["chr"],"align":["left"]},{"label":["count"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["count_correct"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sample_tot_raw"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["f_raw"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["target_f"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["evo_hist"],"name":[8],"type":["chr"],"align":["left"]},{"label":["microcosm_id"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["n_species"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["community_type"],"name":[11],"type":["chr"],"align":["left"]},{"label":["transfers"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["strep_conc"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["replicate"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["plate_well"],"name":[15],"type":["chr"],"align":["left"]},{"label":["plate_no"],"name":[16],"type":["chr"],"align":["left"]},{"label":["notes"],"name":[17],"type":["chr"],"align":["left"]}],"data":[{"1":"P06_s_0","2":"HAMBI_2160","3":"13","4":"37","5":"14114","6":"2.621511e-03","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"4_p10_G01","2":"HAMBI_2160","3":"17","4":"31","5":"758","6":"4.089710e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4m_p18_G01","2":"HAMBI_2160","3":"15","4":"28","5":"873","6":"3.207331e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"P06_s_0","2":"HAMBI_2659","3":"13","4":"28","5":"14114","6":"1.983846e-03","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"4_p10_H01","2":"HAMBI_2659","3":"17","4":"23","5":"821","6":"2.801462e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"P06_s_0","2":"HAMBI_1292","3":"19","4":"23","5":"14114","6":"1.629588e-03","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"4m_p18_G01","2":"HAMBI_1292","3":"25","4":"20","5":"873","6":"2.290951e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_2160","3":"10","4":"18","5":"859","6":"2.095460e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4_p10_H01","2":"HAMBI_2160","3":"8","4":"14","5":"821","6":"1.705238e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4m_p18_B01","2":"HAMBI_1292","3":"18","4":"14","5":"859","6":"1.629802e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_E01","2":"HAMBI_2160","3":"7","4":"13","5":"13952","6":"9.317661e-04","7":"NA","8":"NA","9":"1","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"E01","16":"p18","17":"quartets masterplate"},{"1":"3m_p17_A08","2":"HAMBI_2160","3":"5","4":"11","5":"18311","6":"6.007318e-04","7":"NA","8":"NA","9":"8","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A08","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_2160","3":"7","4":"11","5":"19755","6":"5.568211e-04","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"4_p10_G01","2":"HAMBI_2659","3":"8","4":"11","5":"758","6":"1.451187e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4m_p18_A03","2":"HAMBI_2160","3":"6","4":"11","5":"723","6":"1.521438e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_G01","2":"HAMBI_3031","3":"4","4":"11","5":"873","6":"1.260023e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"3m_p17_A08","2":"HAMBI_1292","3":"10","4":"10","5":"18311","6":"5.461198e-04","7":"NA","8":"NA","9":"8","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A08","16":"p17","17":"trios masterplate"},{"1":"4m_p18_A02","2":"HAMBI_2160","3":"6","4":"10","5":"1066","6":"9.380863e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A02","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A03","2":"HAMBI_1292","3":"13","4":"10","5":"723","6":"1.383126e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_D01","2":"HAMBI_2160","3":"6","4":"10","5":"13548","6":"7.381163e-04","7":"NA","8":"NA","9":"47","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"D01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_G01","2":"HAMBI_2659","3":"7","4":"10","5":"873","6":"1.145475e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"3m_p17_A12","2":"HAMBI_1292","3":"12","4":"9","5":"23312","6":"3.860673e-04","7":"NA","8":"NA","9":"12","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A12","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A12","2":"HAMBI_2160","3":"5","4":"9","5":"23312","6":"3.860673e-04","7":"NA","8":"NA","9":"12","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A12","16":"p17","17":"trios masterplate"},{"1":"4m_p18_B01","2":"HAMBI_1279","3":"12","4":"9","5":"859","6":"1.047730e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"P06_s_0","2":"HAMBI_1279","3":"7","4":"9","5":"14114","6":"6.376647e-04","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"P06_s_0","2":"HAMBI_2164","3":"5","4":"9","5":"14114","6":"6.376647e-04","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"4_p10_B01","2":"HAMBI_3031","3":"3","4":"8","5":"690","6":"1.159420e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"B01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_2164","3":"7","4":"8","5":"821","6":"9.744214e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_2494","3":"6","4":"8","5":"821","6":"9.744214e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4m_p18_G01","2":"HAMBI_1842","3":"6","4":"8","5":"873","6":"9.163803e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"P06_s_0","2":"HAMBI_1972","3":"9","4":"8","5":"14114","6":"5.668131e-04","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"3m_p17_A09","2":"HAMBI_2659","3":"6","4":"7","5":"22153","6":"3.159843e-04","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_3031","3":"3","4":"7","5":"22153","6":"3.159843e-04","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"4_p10_A08","2":"HAMBI_0262","3":"3","4":"7","5":"12407","6":"5.641976e-04","7":"NA","8":"NA","9":"28","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A08","16":"p10","17":"NA"},{"1":"4_p10_G01","2":"HAMBI_2159","3":"5","4":"7","5":"758","6":"9.234828e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_1279","3":"9","4":"7","5":"821","6":"8.526188e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_2159","3":"5","4":"7","5":"821","6":"8.526188e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"3m_p17_A09","2":"HAMBI_1292","3":"9","4":"6","5":"22153","6":"2.708437e-04","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_2160","3":"4","4":"6","5":"22153","6":"2.708437e-04","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_1292","3":"9","4":"6","5":"19755","6":"3.037206e-04","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A11","2":"HAMBI_1292","3":"8","4":"6","5":"19327","6":"3.104465e-04","7":"NA","8":"NA","9":"11","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A11","16":"p17","17":"trios masterplate"},{"1":"4_p10_A03","2":"HAMBI_2160","3":"3","4":"6","5":"598","6":"1.003344e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A03","16":"p10","17":"negative control"},{"1":"4_p10_A03","2":"HAMBI_2659","3":"4","4":"6","5":"598","6":"1.003344e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A03","16":"p10","17":"negative control"},{"1":"4_p10_A04","2":"HAMBI_2160","3":"3","4":"6","5":"592","6":"1.013514e-02","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A04","16":"p10","17":"negative control"},{"1":"4_p10_B01","2":"HAMBI_2160","3":"3","4":"6","5":"690","6":"8.695652e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"B01","16":"p10","17":"negative control"},{"1":"4_p10_B01","2":"HAMBI_2659","3":"4","4":"6","5":"690","6":"8.695652e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"B01","16":"p10","17":"negative control"},{"1":"4_p10_F01","2":"HAMBI_2659","3":"4","4":"6","5":"20595","6":"2.913328e-04","7":"NA","8":"NA","9":"33","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"F01","16":"p10","17":"NA"},{"1":"4_p10_G01","2":"HAMBI_1972","3":"11","4":"6","5":"758","6":"7.915567e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4m_p18_C01","2":"HAMBI_1292","3":"8","4":"6","5":"15556","6":"3.857033e-04","7":"NA","8":"NA","9":"15","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"C01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_G01","2":"HAMBI_1279","3":"8","4":"6","5":"873","6":"6.872852e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_G01","2":"HAMBI_1299","3":"9","4":"6","5":"873","6":"6.872852e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"P06_s_0","2":"HAMBI_0006","3":"5","4":"6","5":"14114","6":"4.251098e-04","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"3m_p17_A07","2":"HAMBI_1842","3":"3","4":"5","5":"16882","6":"2.961734e-04","7":"NA","8":"NA","9":"7","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A07","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A12","2":"HAMBI_1279","3":"6","4":"5","5":"23312","6":"2.144818e-04","7":"NA","8":"NA","9":"12","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A12","16":"p17","17":"trios masterplate"},{"1":"4_p10_A07","2":"HAMBI_2160","3":"2","4":"5","5":"17624","6":"2.837040e-04","7":"NA","8":"NA","9":"27","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A07","16":"p10","17":"NA"},{"1":"4_p10_A08","2":"HAMBI_2659","3":"3","4":"5","5":"12407","6":"4.029983e-04","7":"NA","8":"NA","9":"28","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A08","16":"p10","17":"NA"},{"1":"4_p10_A09","2":"HAMBI_2160","3":"3","4":"5","5":"13231","6":"3.779004e-04","7":"NA","8":"NA","9":"29","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A09","16":"p10","17":"NA"},{"1":"4_p10_C01","2":"HAMBI_1279","3":"7","4":"5","5":"18083","6":"2.765028e-04","7":"NA","8":"NA","9":"15","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C01","16":"p10","17":"NA"},{"1":"4_p10_C01","2":"HAMBI_2160","3":"3","4":"5","5":"18083","6":"2.765028e-04","7":"NA","8":"NA","9":"15","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C01","16":"p10","17":"NA"},{"1":"4_p10_C01","2":"HAMBI_3031","3":"2","4":"5","5":"18083","6":"2.765028e-04","7":"NA","8":"NA","9":"15","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C01","16":"p10","17":"NA"},{"1":"4_p10_G01","2":"HAMBI_1299","3":"8","4":"5","5":"758","6":"6.596306e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4_p10_G01","2":"HAMBI_2164","3":"5","4":"5","5":"758","6":"6.596306e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_0262","3":"3","4":"5","5":"821","6":"6.090134e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_1292","3":"6","4":"5","5":"821","6":"6.090134e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_3031","3":"2","4":"5","5":"821","6":"6.090134e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4m_p18_A03","2":"HAMBI_1299","3":"7","4":"5","5":"723","6":"6.915629e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_1842","3":"4","4":"5","5":"859","6":"5.820722e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_2164","3":"5","4":"5","5":"859","6":"5.820722e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_2659","3":"4","4":"5","5":"859","6":"5.820722e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_C01","2":"HAMBI_2160","3":"3","4":"5","5":"15556","6":"3.214194e-04","7":"NA","8":"NA","9":"15","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"C01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_C01","2":"HAMBI_3031","3":"2","4":"5","5":"15556","6":"3.214194e-04","7":"NA","8":"NA","9":"15","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"C01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_F01","2":"HAMBI_2160","3":"3","4":"5","5":"15433","6":"3.239811e-04","7":"NA","8":"NA","9":"33","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"F01","16":"p18","17":"quartets masterplate"},{"1":"3m_p17_A07","2":"HAMBI_0262","3":"2","4":"4","5":"16882","6":"2.369388e-04","7":"NA","8":"NA","9":"7","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A07","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_2659","3":"3","4":"4","5":"19755","6":"2.024804e-04","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A11","2":"HAMBI_2164","3":"4","4":"4","5":"19327","6":"2.069644e-04","7":"NA","8":"NA","9":"11","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A11","16":"p17","17":"trios masterplate"},{"1":"4_p10_A02","2":"HAMBI_2160","3":"2","4":"4","5":"777","6":"5.148005e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A02","16":"p10","17":"negative control"},{"1":"4_p10_A02","2":"HAMBI_2659","3":"3","4":"4","5":"777","6":"5.148005e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A02","16":"p10","17":"negative control"},{"1":"4_p10_A05","2":"HAMBI_1299","3":"5","4":"4","5":"18514","6":"2.160527e-04","7":"NA","8":"NA","9":"25","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A05","16":"p10","17":"NA"},{"1":"4_p10_C01","2":"HAMBI_2659","3":"3","4":"4","5":"18083","6":"2.212022e-04","7":"NA","8":"NA","9":"15","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C01","16":"p10","17":"NA"},{"1":"4_p10_F01","2":"HAMBI_2160","3":"2","4":"4","5":"20595","6":"1.942219e-04","7":"NA","8":"NA","9":"33","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"F01","16":"p10","17":"NA"},{"1":"4_p10_G01","2":"HAMBI_0262","3":"2","4":"4","5":"758","6":"5.277045e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4_p10_G01","2":"HAMBI_1279","3":"5","4":"4","5":"758","6":"5.277045e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4_p10_G01","2":"HAMBI_2494","3":"3","4":"4","5":"758","6":"5.277045e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_0006","3":"5","4":"4","5":"821","6":"4.872107e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_1299","3":"6","4":"4","5":"821","6":"4.872107e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_1842","3":"3","4":"4","5":"821","6":"4.872107e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_1972","3":"8","4":"4","5":"821","6":"4.872107e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4m_p18_A02","2":"HAMBI_1292","3":"5","4":"4","5":"1066","6":"3.752345e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A02","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_0262","3":"2","4":"4","5":"859","6":"4.656577e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_C01","2":"HAMBI_2494","3":"3","4":"4","5":"15556","6":"2.571355e-04","7":"NA","8":"NA","9":"15","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"C01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_D01","2":"HAMBI_1292","3":"6","4":"4","5":"13548","6":"2.952465e-04","7":"NA","8":"NA","9":"47","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"D01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_E01","2":"HAMBI_2659","3":"3","4":"4","5":"13952","6":"2.866972e-04","7":"NA","8":"NA","9":"1","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"E01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_F01","2":"HAMBI_1292","3":"5","4":"4","5":"15433","6":"2.591849e-04","7":"NA","8":"NA","9":"33","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"F01","16":"p18","17":"quartets masterplate"},{"1":"P06_s_0","2":"HAMBI_0097","3":"3","4":"4","5":"14114","6":"2.834065e-04","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"P06_s_0","2":"HAMBI_1299","3":"4","4":"4","5":"14114","6":"2.834065e-04","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"P06_s_0","2":"HAMBI_1842","3":"2","4":"4","5":"14114","6":"2.834065e-04","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"3m_p17_A07","2":"HAMBI_2494","3":"2","4":"3","5":"16882","6":"1.777041e-04","7":"NA","8":"NA","9":"7","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A07","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A07","2":"HAMBI_2659","3":"2","4":"3","5":"16882","6":"1.777041e-04","7":"NA","8":"NA","9":"7","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A07","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_1842","3":"3","4":"3","5":"22153","6":"1.354218e-04","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_2164","3":"3","4":"3","5":"22153","6":"1.354218e-04","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_1279","3":"4","4":"3","5":"19755","6":"1.518603e-04","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_1972","3":"7","4":"3","5":"19755","6":"1.518603e-04","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_2164","3":"3","4":"3","5":"19755","6":"1.518603e-04","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A11","2":"HAMBI_2159","3":"2","4":"3","5":"19327","6":"1.552233e-04","7":"NA","8":"NA","9":"11","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A11","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A12","2":"HAMBI_1842","3":"2","4":"3","5":"23312","6":"1.286891e-04","7":"NA","8":"NA","9":"12","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A12","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A12","2":"HAMBI_2659","3":"2","4":"3","5":"23312","6":"1.286891e-04","7":"NA","8":"NA","9":"12","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A12","16":"p17","17":"trios masterplate"},{"1":"4_p09_A11","2":"HAMBI_1279","3":"4","4":"3","5":"13206","6":"2.271695e-04","7":"NA","8":"NA","9":"31","10":"4","11":"experiment","12":"8","13":"0","14":"1","15":"A11","16":"p09","17":"NA"},{"1":"4_p10_A03","2":"HAMBI_1299","3":"4","4":"3","5":"598","6":"5.016722e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A03","16":"p10","17":"negative control"},{"1":"4_p10_A03","2":"HAMBI_1842","3":"2","4":"3","5":"598","6":"5.016722e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A03","16":"p10","17":"negative control"},{"1":"4_p10_A03","2":"HAMBI_3031","3":"1","4":"3","5":"598","6":"5.016722e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A03","16":"p10","17":"negative control"},{"1":"4_p10_A05","2":"HAMBI_2494","3":"2","4":"3","5":"18514","6":"1.620395e-04","7":"NA","8":"NA","9":"25","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A05","16":"p10","17":"NA"},{"1":"4_p10_A05","2":"HAMBI_3031","3":"1","4":"3","5":"18514","6":"1.620395e-04","7":"NA","8":"NA","9":"25","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A05","16":"p10","17":"NA"},{"1":"4_p10_A08","2":"HAMBI_1299","3":"3","4":"3","5":"12407","6":"2.417990e-04","7":"NA","8":"NA","9":"28","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A08","16":"p10","17":"NA"},{"1":"4_p10_A09","2":"HAMBI_1292","3":"4","4":"3","5":"13231","6":"2.267402e-04","7":"NA","8":"NA","9":"29","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A09","16":"p10","17":"NA"},{"1":"4_p10_A09","2":"HAMBI_2164","3":"3","4":"3","5":"13231","6":"2.267402e-04","7":"NA","8":"NA","9":"29","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A09","16":"p10","17":"NA"},{"1":"4_p10_B01","2":"HAMBI_1972","3":"6","4":"3","5":"690","6":"4.347826e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"B01","16":"p10","17":"negative control"},{"1":"4_p10_D01","2":"HAMBI_1279","3":"4","4":"3","5":"17088","6":"1.755618e-04","7":"NA","8":"NA","9":"47","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"D01","16":"p10","17":"NA"},{"1":"4_p10_D01","2":"HAMBI_1299","3":"4","4":"3","5":"17088","6":"1.755618e-04","7":"NA","8":"NA","9":"47","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"D01","16":"p10","17":"NA"},{"1":"4_p10_D01","2":"HAMBI_2659","3":"2","4":"3","5":"17088","6":"1.755618e-04","7":"NA","8":"NA","9":"47","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"D01","16":"p10","17":"NA"},{"1":"4_p10_E01","2":"HAMBI_1279","3":"4","4":"3","5":"14404","6":"2.082755e-04","7":"NA","8":"NA","9":"1","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"E01","16":"p10","17":"NA"},{"1":"4_p10_F01","2":"HAMBI_0105","3":"2","4":"3","5":"20595","6":"1.456664e-04","7":"NA","8":"NA","9":"33","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"F01","16":"p10","17":"NA"},{"1":"4_p10_H01","2":"HAMBI_1988","3":"3","4":"3","5":"821","6":"3.654080e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_2792","3":"2","4":"3","5":"821","6":"3.654080e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4m_p18_A02","2":"HAMBI_1842","3":"2","4":"3","5":"1066","6":"2.814259e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A02","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A02","2":"HAMBI_2494","3":"2","4":"3","5":"1066","6":"2.814259e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A02","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A02","2":"HAMBI_3031","3":"1","4":"3","5":"1066","6":"2.814259e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A02","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A03","2":"HAMBI_1842","3":"2","4":"3","5":"723","6":"4.149378e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A03","2":"HAMBI_2659","3":"2","4":"3","5":"723","6":"4.149378e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A03","2":"HAMBI_3031","3":"1","4":"3","5":"723","6":"4.149378e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_2159","3":"2","4":"3","5":"859","6":"3.492433e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_2494","3":"2","4":"3","5":"859","6":"3.492433e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_C01","2":"HAMBI_0262","3":"2","4":"3","5":"15556","6":"1.928516e-04","7":"NA","8":"NA","9":"15","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"C01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_C01","2":"HAMBI_2659","3":"2","4":"3","5":"15556","6":"1.928516e-04","7":"NA","8":"NA","9":"15","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"C01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_D01","2":"HAMBI_1279","3":"4","4":"3","5":"13548","6":"2.214349e-04","7":"NA","8":"NA","9":"47","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"D01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_F01","2":"HAMBI_1279","3":"4","4":"3","5":"15433","6":"1.943886e-04","7":"NA","8":"NA","9":"33","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"F01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_F01","2":"HAMBI_1842","3":"2","4":"3","5":"15433","6":"1.943886e-04","7":"NA","8":"NA","9":"33","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"F01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_F01","2":"HAMBI_1972","3":"5","4":"3","5":"15433","6":"1.943886e-04","7":"NA","8":"NA","9":"33","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"F01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_G01","2":"HAMBI_1972","3":"6","4":"3","5":"873","6":"3.436426e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_G01","2":"HAMBI_2159","3":"2","4":"3","5":"873","6":"3.436426e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"P06_s_0","2":"HAMBI_1988","3":"2","4":"3","5":"14114","6":"2.125549e-04","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"3m_p17_A07","2":"HAMBI_1972","3":"3","4":"2","5":"16882","6":"1.184694e-04","7":"NA","8":"NA","9":"7","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A07","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A07","2":"HAMBI_2160","3":"1","4":"2","5":"16882","6":"1.184694e-04","7":"NA","8":"NA","9":"7","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A07","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A08","2":"HAMBI_0262","3":"1","4":"2","5":"18311","6":"1.092240e-04","7":"NA","8":"NA","9":"8","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A08","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A08","2":"HAMBI_1299","3":"2","4":"2","5":"18311","6":"1.092240e-04","7":"NA","8":"NA","9":"8","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A08","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A08","2":"HAMBI_1842","3":"1","4":"2","5":"18311","6":"1.092240e-04","7":"NA","8":"NA","9":"8","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A08","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_0262","3":"1","4":"2","5":"22153","6":"9.028123e-05","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_1299","3":"4","4":"2","5":"19755","6":"1.012402e-04","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_1988","3":"2","4":"2","5":"19755","6":"1.012402e-04","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_2159","3":"2","4":"2","5":"19755","6":"1.012402e-04","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_2494","3":"2","4":"2","5":"19755","6":"1.012402e-04","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A11","2":"HAMBI_1299","3":"3","4":"2","5":"19327","6":"1.034822e-04","7":"NA","8":"NA","9":"11","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A11","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A12","2":"HAMBI_2164","3":"2","4":"2","5":"23312","6":"8.579272e-05","7":"NA","8":"NA","9":"12","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A12","16":"p17","17":"trios masterplate"},{"1":"3m_p17_C05","2":"HAMBI_1972","3":"3","4":"2","5":"17619","6":"1.135138e-04","7":"NA","8":"NA","9":"17","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"C05","16":"p17","17":"trios masterplate"},{"1":"4_p09_A12","2":"HAMBI_0262","3":"1","4":"2","5":"15608","6":"1.281394e-04","7":"NA","8":"NA","9":"32","10":"4","11":"experiment","12":"8","13":"0","14":"1","15":"A12","16":"p09","17":"NA"},{"1":"4_p09_A12","2":"HAMBI_2160","3":"1","4":"2","5":"15608","6":"1.281394e-04","7":"NA","8":"NA","9":"32","10":"4","11":"experiment","12":"8","13":"0","14":"1","15":"A12","16":"p09","17":"NA"},{"1":"4_p10_A02","2":"HAMBI_0097","3":"2","4":"2","5":"777","6":"2.574003e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A02","16":"p10","17":"negative control"},{"1":"4_p10_A02","2":"HAMBI_0262","3":"1","4":"2","5":"777","6":"2.574003e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A02","16":"p10","17":"negative control"},{"1":"4_p10_A03","2":"HAMBI_1988","3":"2","4":"2","5":"598","6":"3.344482e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A03","16":"p10","17":"negative control"},{"1":"4_p10_A03","2":"HAMBI_2164","3":"2","4":"2","5":"598","6":"3.344482e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A03","16":"p10","17":"negative control"},{"1":"4_p10_A04","2":"HAMBI_2164","3":"2","4":"2","5":"592","6":"3.378378e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A04","16":"p10","17":"negative control"},{"1":"4_p10_A05","2":"HAMBI_0262","3":"1","4":"2","5":"18514","6":"1.080264e-04","7":"NA","8":"NA","9":"25","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A05","16":"p10","17":"NA"},{"1":"4_p10_A06","2":"HAMBI_2160","3":"1","4":"2","5":"14551","6":"1.374476e-04","7":"NA","8":"NA","9":"26","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A06","16":"p10","17":"NA"},{"1":"4_p10_A06","2":"HAMBI_2659","3":"1","4":"2","5":"14551","6":"1.374476e-04","7":"NA","8":"NA","9":"26","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A06","16":"p10","17":"NA"},{"1":"4_p10_A07","2":"HAMBI_0262","3":"1","4":"2","5":"17624","6":"1.134816e-04","7":"NA","8":"NA","9":"27","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A07","16":"p10","17":"NA"},{"1":"4_p10_A07","2":"HAMBI_1299","3":"2","4":"2","5":"17624","6":"1.134816e-04","7":"NA","8":"NA","9":"27","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A07","16":"p10","17":"NA"},{"1":"4_p10_A08","2":"HAMBI_1842","3":"1","4":"2","5":"12407","6":"1.611993e-04","7":"NA","8":"NA","9":"28","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A08","16":"p10","17":"NA"},{"1":"4_p10_A08","2":"HAMBI_2159","3":"1","4":"2","5":"12407","6":"1.611993e-04","7":"NA","8":"NA","9":"28","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A08","16":"p10","17":"NA"},{"1":"4_p10_A09","2":"HAMBI_2659","3":"2","4":"2","5":"13231","6":"1.511602e-04","7":"NA","8":"NA","9":"29","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A09","16":"p10","17":"NA"},{"1":"4_p10_B01","2":"HAMBI_1292","3":"2","4":"2","5":"690","6":"2.898551e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"B01","16":"p10","17":"negative control"},{"1":"4_p10_B01","2":"HAMBI_1299","3":"3","4":"2","5":"690","6":"2.898551e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"B01","16":"p10","17":"negative control"},{"1":"4_p10_C01","2":"HAMBI_0006","3":"3","4":"2","5":"18083","6":"1.106011e-04","7":"NA","8":"NA","9":"15","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C01","16":"p10","17":"NA"},{"1":"4_p10_C01","2":"HAMBI_2164","3":"2","4":"2","5":"18083","6":"1.106011e-04","7":"NA","8":"NA","9":"15","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C01","16":"p10","17":"NA"},{"1":"4_p10_D01","2":"HAMBI_2164","3":"2","4":"2","5":"17088","6":"1.170412e-04","7":"NA","8":"NA","9":"47","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"D01","16":"p10","17":"NA"},{"1":"4_p10_F01","2":"HAMBI_1988","3":"2","4":"2","5":"20595","6":"9.711095e-05","7":"NA","8":"NA","9":"33","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"F01","16":"p10","17":"NA"},{"1":"4_p10_F01","2":"HAMBI_2159","3":"1","4":"2","5":"20595","6":"9.711095e-05","7":"NA","8":"NA","9":"33","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"F01","16":"p10","17":"NA"},{"1":"4_p10_F01","2":"HAMBI_2164","3":"2","4":"2","5":"20595","6":"9.711095e-05","7":"NA","8":"NA","9":"33","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"F01","16":"p10","17":"NA"},{"1":"4_p10_G01","2":"HAMBI_0006","3":"3","4":"2","5":"758","6":"2.638522e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4_p10_H01","2":"HAMBI_0097","3":"2","4":"2","5":"821","6":"2.436054e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H01","16":"p10","17":"negative control"},{"1":"4_p10_H05","2":"HAMBI_1842","3":"1","4":"2","5":"855","6":"2.339181e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H05","16":"p10","17":"negative control"},{"1":"4m_p18_A03","2":"HAMBI_0262","3":"1","4":"2","5":"723","6":"2.766252e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_0006","3":"3","4":"2","5":"859","6":"2.328289e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_1972","3":"4","4":"2","5":"859","6":"2.328289e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_1988","3":"2","4":"2","5":"859","6":"2.328289e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_C01","2":"HAMBI_1972","3":"3","4":"2","5":"15556","6":"1.285678e-04","7":"NA","8":"NA","9":"15","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"C01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_D01","2":"HAMBI_0006","3":"3","4":"2","5":"13548","6":"1.476233e-04","7":"NA","8":"NA","9":"47","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"D01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_E01","2":"HAMBI_0006","3":"2","4":"2","5":"13952","6":"1.433486e-04","7":"NA","8":"NA","9":"1","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"E01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_E01","2":"HAMBI_1279","3":"2","4":"2","5":"13952","6":"1.433486e-04","7":"NA","8":"NA","9":"1","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"E01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_E01","2":"HAMBI_1972","3":"3","4":"2","5":"13952","6":"1.433486e-04","7":"NA","8":"NA","9":"1","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"E01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_E01","2":"HAMBI_2164","3":"2","4":"2","5":"13952","6":"1.433486e-04","7":"NA","8":"NA","9":"1","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"E01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_F01","2":"HAMBI_0006","3":"2","4":"2","5":"15433","6":"1.295924e-04","7":"NA","8":"NA","9":"33","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"F01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_G01","2":"HAMBI_0262","3":"1","4":"2","5":"873","6":"2.290951e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_G01","2":"HAMBI_1988","3":"2","4":"2","5":"873","6":"2.290951e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_G01","2":"HAMBI_2164","3":"2","4":"2","5":"873","6":"2.290951e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_G09","2":"HAMBI_0262","3":"1","4":"2","5":"1003","6":"1.994018e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"G09","16":"p18","17":"quartets masterplate empty well"},{"1":"P06_s_0","2":"HAMBI_2494","3":"1","4":"2","5":"14114","6":"1.417033e-04","7":"NA","8":"NA","9":"NA","10":"2","11":"masterplate","12":"0","13":"0","14":"1","15":"H01","16":"p18","17":"P06_s_0"},{"1":"3_p01_E01","2":"HAMBI_1972","3":"1","4":"1","5":"16300","6":"6.134969e-05","7":"NA","8":"NA","9":"25","10":"3","11":"experiment","12":"8","13":"0","14":"1","15":"E01","16":"p01","17":"NA"},{"1":"3_p02_C12","2":"HAMBI_1292","3":"1","4":"1","5":"16045","6":"6.232471e-05","7":"NA","8":"NA","9":"24","10":"3","11":"experiment","12":"8","13":"0","14":"2","15":"C12","16":"p02","17":"NA"},{"1":"3m_p17_A07","2":"HAMBI_1279","3":"1","4":"1","5":"16882","6":"5.923469e-05","7":"NA","8":"NA","9":"7","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A07","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A07","2":"HAMBI_1299","3":"1","4":"1","5":"16882","6":"5.923469e-05","7":"NA","8":"NA","9":"7","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A07","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A08","2":"HAMBI_0006","3":"1","4":"1","5":"18311","6":"5.461198e-05","7":"NA","8":"NA","9":"8","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A08","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A08","2":"HAMBI_1972","3":"1","4":"1","5":"18311","6":"5.461198e-05","7":"NA","8":"NA","9":"8","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A08","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A08","2":"HAMBI_1988","3":"1","4":"1","5":"18311","6":"5.461198e-05","7":"NA","8":"NA","9":"8","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A08","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_0097","3":"1","4":"1","5":"22153","6":"4.514061e-05","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_1279","3":"2","4":"1","5":"22153","6":"4.514061e-05","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_1299","3":"1","4":"1","5":"22153","6":"4.514061e-05","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_1972","3":"3","4":"1","5":"22153","6":"4.514061e-05","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_1988","3":"1","4":"1","5":"22153","6":"4.514061e-05","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A09","2":"HAMBI_2159","3":"1","4":"1","5":"22153","6":"4.514061e-05","7":"NA","8":"NA","9":"9","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A09","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_0097","3":"1","4":"1","5":"19755","6":"5.062010e-05","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A10","2":"HAMBI_3237","3":"1","4":"1","5":"19755","6":"5.062010e-05","7":"NA","8":"NA","9":"10","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A10","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A11","2":"HAMBI_1279","3":"1","4":"1","5":"19327","6":"5.174109e-05","7":"NA","8":"NA","9":"11","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A11","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A11","2":"HAMBI_3237","3":"1","4":"1","5":"19327","6":"5.174109e-05","7":"NA","8":"NA","9":"11","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A11","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A12","2":"HAMBI_1299","3":"2","4":"1","5":"23312","6":"4.289636e-05","7":"NA","8":"NA","9":"12","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A12","16":"p17","17":"trios masterplate"},{"1":"3m_p17_A12","2":"HAMBI_1988","3":"1","4":"1","5":"23312","6":"4.289636e-05","7":"NA","8":"NA","9":"12","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"A12","16":"p17","17":"trios masterplate"},{"1":"3m_p17_E11","2":"HAMBI_1292","3":"1","4":"1","5":"18078","6":"5.531585e-05","7":"NA","8":"NA","9":"35","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"E11","16":"p17","17":"trios masterplate"},{"1":"3m_p17_H06","2":"HAMBI_0262","3":"1","4":"1","5":"21671","6":"4.614462e-05","7":"NA","8":"NA","9":"90","10":"3","11":"masterplate","12":"0","13":"0","14":"1","15":"H06","16":"p17","17":"trios masterplate"},{"1":"4_p09_A11","2":"HAMBI_1972","3":"2","4":"1","5":"13206","6":"7.572316e-05","7":"NA","8":"NA","9":"31","10":"4","11":"experiment","12":"8","13":"0","14":"1","15":"A11","16":"p09","17":"NA"},{"1":"4_p09_A11","2":"HAMBI_2164","3":"1","4":"1","5":"13206","6":"7.572316e-05","7":"NA","8":"NA","9":"31","10":"4","11":"experiment","12":"8","13":"0","14":"1","15":"A11","16":"p09","17":"NA"},{"1":"4_p09_A12","2":"HAMBI_1292","3":"1","4":"1","5":"15608","6":"6.406971e-05","7":"NA","8":"NA","9":"32","10":"4","11":"experiment","12":"8","13":"0","14":"1","15":"A12","16":"p09","17":"NA"},{"1":"4_p09_A12","2":"HAMBI_1988","3":"1","4":"1","5":"15608","6":"6.406971e-05","7":"NA","8":"NA","9":"32","10":"4","11":"experiment","12":"8","13":"0","14":"1","15":"A12","16":"p09","17":"NA"},{"1":"4_p10_A02","2":"HAMBI_0105","3":"1","4":"1","5":"777","6":"1.287001e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A02","16":"p10","17":"negative control"},{"1":"4_p10_A02","2":"HAMBI_1299","3":"2","4":"1","5":"777","6":"1.287001e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A02","16":"p10","17":"negative control"},{"1":"4_p10_A02","2":"HAMBI_1972","3":"1","4":"1","5":"777","6":"1.287001e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A02","16":"p10","17":"negative control"},{"1":"4_p10_A02","2":"HAMBI_1988","3":"1","4":"1","5":"777","6":"1.287001e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A02","16":"p10","17":"negative control"},{"1":"4_p10_A03","2":"HAMBI_1972","3":"2","4":"1","5":"598","6":"1.672241e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"A03","16":"p10","17":"negative control"},{"1":"4_p10_A05","2":"HAMBI_0006","3":"1","4":"1","5":"18514","6":"5.401318e-05","7":"NA","8":"NA","9":"25","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A05","16":"p10","17":"NA"},{"1":"4_p10_A05","2":"HAMBI_1292","3":"1","4":"1","5":"18514","6":"5.401318e-05","7":"NA","8":"NA","9":"25","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A05","16":"p10","17":"NA"},{"1":"4_p10_A05","2":"HAMBI_1842","3":"1","4":"1","5":"18514","6":"5.401318e-05","7":"NA","8":"NA","9":"25","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A05","16":"p10","17":"NA"},{"1":"4_p10_A06","2":"HAMBI_0006","3":"1","4":"1","5":"14551","6":"6.872380e-05","7":"NA","8":"NA","9":"26","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A06","16":"p10","17":"NA"},{"1":"4_p10_A06","2":"HAMBI_1972","3":"2","4":"1","5":"14551","6":"6.872380e-05","7":"NA","8":"NA","9":"26","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A06","16":"p10","17":"NA"},{"1":"4_p10_A06","2":"HAMBI_2164","3":"1","4":"1","5":"14551","6":"6.872380e-05","7":"NA","8":"NA","9":"26","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A06","16":"p10","17":"NA"},{"1":"4_p10_A09","2":"HAMBI_0006","3":"1","4":"1","5":"13231","6":"7.558008e-05","7":"NA","8":"NA","9":"29","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"A09","16":"p10","17":"NA"},{"1":"4_p10_B01","2":"HAMBI_0006","3":"1","4":"1","5":"690","6":"1.449275e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"B01","16":"p10","17":"negative control"},{"1":"4_p10_B01","2":"HAMBI_2494","3":"1","4":"1","5":"690","6":"1.449275e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"B01","16":"p10","17":"negative control"},{"1":"4_p10_C01","2":"HAMBI_0097","3":"1","4":"1","5":"18083","6":"5.530056e-05","7":"NA","8":"NA","9":"15","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C01","16":"p10","17":"NA"},{"1":"4_p10_C01","2":"HAMBI_1292","3":"1","4":"1","5":"18083","6":"5.530056e-05","7":"NA","8":"NA","9":"15","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C01","16":"p10","17":"NA"},{"1":"4_p10_C01","2":"HAMBI_1299","3":"1","4":"1","5":"18083","6":"5.530056e-05","7":"NA","8":"NA","9":"15","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C01","16":"p10","17":"NA"},{"1":"4_p10_C01","2":"HAMBI_1972","3":"3","4":"1","5":"18083","6":"5.530056e-05","7":"NA","8":"NA","9":"15","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C01","16":"p10","17":"NA"},{"1":"4_p10_C06","2":"HAMBI_1972","3":"1","4":"1","5":"14003","6":"7.141327e-05","7":"NA","8":"NA","9":"10","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"C06","16":"p10","17":"NA"},{"1":"4_p10_D01","2":"HAMBI_0006","3":"2","4":"1","5":"17088","6":"5.852060e-05","7":"NA","8":"NA","9":"47","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"D01","16":"p10","17":"NA"},{"1":"4_p10_D01","2":"HAMBI_1972","3":"1","4":"1","5":"17088","6":"5.852060e-05","7":"NA","8":"NA","9":"47","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"D01","16":"p10","17":"NA"},{"1":"4_p10_E01","2":"HAMBI_0097","3":"1","4":"1","5":"14404","6":"6.942516e-05","7":"NA","8":"NA","9":"1","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"E01","16":"p10","17":"NA"},{"1":"4_p10_E01","2":"HAMBI_1292","3":"1","4":"1","5":"14404","6":"6.942516e-05","7":"NA","8":"NA","9":"1","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"E01","16":"p10","17":"NA"},{"1":"4_p10_E01","2":"HAMBI_1299","3":"1","4":"1","5":"14404","6":"6.942516e-05","7":"NA","8":"NA","9":"1","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"E01","16":"p10","17":"NA"},{"1":"4_p10_E01","2":"HAMBI_1842","3":"1","4":"1","5":"14404","6":"6.942516e-05","7":"NA","8":"NA","9":"1","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"E01","16":"p10","17":"NA"},{"1":"4_p10_E01","2":"HAMBI_1972","3":"2","4":"1","5":"14404","6":"6.942516e-05","7":"NA","8":"NA","9":"1","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"E01","16":"p10","17":"NA"},{"1":"4_p10_E01","2":"HAMBI_1988","3":"1","4":"1","5":"14404","6":"6.942516e-05","7":"NA","8":"NA","9":"1","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"E01","16":"p10","17":"NA"},{"1":"4_p10_E01","2":"HAMBI_2659","3":"1","4":"1","5":"14404","6":"6.942516e-05","7":"NA","8":"NA","9":"1","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"E01","16":"p10","17":"NA"},{"1":"4_p10_E07","2":"HAMBI_0006","3":"1","4":"1","5":"13015","6":"7.683442e-05","7":"NA","8":"NA","9":"7","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"E07","16":"p10","17":"NA"},{"1":"4_p10_F01","2":"HAMBI_1279","3":"1","4":"1","5":"20595","6":"4.855547e-05","7":"NA","8":"NA","9":"33","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"F01","16":"p10","17":"NA"},{"1":"4_p10_F01","2":"HAMBI_1299","3":"1","4":"1","5":"20595","6":"4.855547e-05","7":"NA","8":"NA","9":"33","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"F01","16":"p10","17":"NA"},{"1":"4_p10_F01","2":"HAMBI_3237","3":"1","4":"1","5":"20595","6":"4.855547e-05","7":"NA","8":"NA","9":"33","10":"4","11":"experiment","12":"8","13":"0","14":"2","15":"F01","16":"p10","17":"NA"},{"1":"4_p10_G01","2":"HAMBI_1292","3":"1","4":"1","5":"758","6":"1.319261e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4_p10_G01","2":"HAMBI_3237","3":"1","4":"1","5":"758","6":"1.319261e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G01","16":"p10","17":"negative control"},{"1":"4_p10_G02","2":"HAMBI_0105","3":"1","4":"1","5":"678","6":"1.474926e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"G02","16":"p10","17":"negative control"},{"1":"4_p10_H03","2":"HAMBI_0006","3":"1","4":"1","5":"525","6":"1.904762e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H03","16":"p10","17":"negative control"},{"1":"4_p10_H03","2":"HAMBI_1972","3":"1","4":"1","5":"525","6":"1.904762e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H03","16":"p10","17":"negative control"},{"1":"4_p10_H04","2":"HAMBI_2159","3":"1","4":"1","5":"582","6":"1.718213e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H04","16":"p10","17":"negative control"},{"1":"4_p10_H09","2":"HAMBI_0006","3":"1","4":"1","5":"832","6":"1.201923e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"neg_control","12":"8","13":"0","14":"2","15":"H09","16":"p10","17":"negative control"},{"1":"4m_p18_A02","2":"HAMBI_1972","3":"1","4":"1","5":"1066","6":"9.380863e-04","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A02","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A02","2":"HAMBI_2659","3":"1","4":"1","5":"1066","6":"9.380863e-04","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A02","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A03","2":"HAMBI_0006","3":"1","4":"1","5":"723","6":"1.383126e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A03","2":"HAMBI_1972","3":"2","4":"1","5":"723","6":"1.383126e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A03","2":"HAMBI_1988","3":"1","4":"1","5":"723","6":"1.383126e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_A03","2":"HAMBI_2159","3":"1","4":"1","5":"723","6":"1.383126e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"A03","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_B01","2":"HAMBI_3237","3":"1","4":"1","5":"859","6":"1.164144e-03","7":"NA","8":"NA","9":"NA","10":"NA","11":"empty","12":"0","13":"0","14":"1","15":"B01","16":"p18","17":"quartets masterplate empty well"},{"1":"4m_p18_C01","2":"HAMBI_0006","3":"2","4":"1","5":"15556","6":"6.428388e-05","7":"NA","8":"NA","9":"15","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"C01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_C01","2":"HAMBI_1299","3":"2","4":"1","5":"15556","6":"6.428388e-05","7":"NA","8":"NA","9":"15","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"C01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_C01","2":"HAMBI_1842","3":"1","4":"1","5":"15556","6":"6.428388e-05","7":"NA","8":"NA","9":"15","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"C01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_D01","2":"HAMBI_1972","3":"2","4":"1","5":"13548","6":"7.381163e-05","7":"NA","8":"NA","9":"47","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"D01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_D01","2":"HAMBI_2659","3":"1","4":"1","5":"13548","6":"7.381163e-05","7":"NA","8":"NA","9":"47","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"D01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_E01","2":"HAMBI_1988","3":"1","4":"1","5":"13952","6":"7.167431e-05","7":"NA","8":"NA","9":"1","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"E01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_E01","2":"HAMBI_2159","3":"1","4":"1","5":"13952","6":"7.167431e-05","7":"NA","8":"NA","9":"1","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"E01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_E01","2":"HAMBI_3237","3":"1","4":"1","5":"13952","6":"7.167431e-05","7":"NA","8":"NA","9":"1","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"E01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_F01","2":"HAMBI_2159","3":"1","4":"1","5":"15433","6":"6.479622e-05","7":"NA","8":"NA","9":"33","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"F01","16":"p18","17":"quartets masterplate"},{"1":"4m_p18_F01","2":"HAMBI_2164","3":"1","4":"1","5":"15433","6":"6.479622e-05","7":"NA","8":"NA","9":"33","10":"4","11":"masterplate","12":"0","13":"0","14":"1","15":"F01","16":"p18","17":"quartets masterplate"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>there are only very small number of reads mapping to off-target species per experimental sample probably from crosstalk leakage.</p>
</section>
<section id="samples-with-few-total-reads" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="samples-with-few-total-reads"><span class="header-section-number">5.4</span> Samples with few total reads</h2>
<p>Some of the experimental pairs had streptomycin concentrations higher than any of the species individually could tolerate. We would expect then that no species would grow successfully in these samples and that the overall biomass would be very low, thus resulting in a low number of recovered reads from these samples.</p>
<p>To look into this. first let’s check which samples have very low OD600 in the endpoint samples. We’ll filter out samples with an OD of less than 0.1 and also samples with fewer than 1000 reads. It is generally good practice to exclude samples with low number of reads.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">left_join</span>(finaltable, od, </span>
<span id="cb18-2"><a href="#cb18-2"></a>          <span class="at">by =</span> <span class="fu">join_by</span>(sample, transfers<span class="sc">==</span>transfer, replicate, strep_conc)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">filter</span>(transfers <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="fu">filter</span>(OD <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">|</span> sample_tot_raw <span class="sc">&lt;</span> <span class="dv">3000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="fu">distinct</span>(sample, community_type, OD, sample_tot_raw) <span class="sc">%&gt;%</span> </span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="fu">count</span>(community_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["community_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"neg_control","2":"50"},{"1":"pos_control","2":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Samples with low reads or low OD are all negative controls or the one positive control that failed (plus another positive control <code>4_p10_A01</code> but this must be from mislabeling because there were no positive controls actually on the experimental plates).</p>
</section>
<section id="filter-to-target-species" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="filter-to-target-species"><span class="header-section-number">5.5</span> Filter to target species</h2>
<p>Exclude positive and negative controls and also exclude species that are not in the focal 4</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>finaltable_exp_mstr <span class="ot">&lt;-</span> finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">filter</span>(community_type <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="st">"empty"</span>, <span class="st">"neg_control"</span>, <span class="st">"pos_control"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="co"># no low-read samples to filter</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="co">#filter(sample %nin% lowread_samps) %&gt;% </span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">filter</span>(strainID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HAMBI_0403"</span>, <span class="st">"HAMBI_1287"</span>, <span class="st">"HAMBI_1896"</span>, <span class="st">"HAMBI_1977"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb19-7"><a href="#cb19-7"></a>  <span class="fu">mutate</span>(<span class="at">f_raw_targetsp =</span> count_correct<span class="sc">/</span><span class="fu">sum</span>(count_correct),</span>
<span id="cb19-8"><a href="#cb19-8"></a>         <span class="at">sample_tot_targetsp =</span> <span class="fu">sum</span>(count_correct)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="fu">relocate</span>(<span class="fu">c</span>(sample_tot_targetsp, f_raw_targetsp), <span class="at">.after =</span> f_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="masterplate-samples" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="masterplate-samples"><span class="header-section-number">5.6</span> Masterplate samples</h2>
<section id="pairs" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="pairs"><span class="header-section-number">5.6.1</span> Pairs</h3>
<p>Something a bit weird is going on with two of the masterplate pairs. Samples P19 and P20 both somehow have ~20 of HAMBI_0403 present in them. However, the rest of the species composition looks like how we expect them. I think we will keep these two masterplate samples and just filter out the HAMBI_0403 that shouldn’t be there</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"masterplate"</span>) <span class="sc">&amp;</span> n_species <span class="sc">==</span> <span class="dv">2</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, strainID, f_raw_targetsp, target_f, evo_hist) <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">mutate</span>(<span class="at">f_raw_targetsp =</span> <span class="fu">round</span>(f_raw_targetsp, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sample"],"name":[1],"type":["chr"],"align":["left"]},{"label":["strainID"],"name":[2],"type":["chr"],"align":["left"]},{"label":["f_raw_targetsp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["target_f"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["evo_hist"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"P06_s_0","2":"HAMBI_0403","3":"0.90","4":"0.9","5":"anc"},{"1":"P06_s_0","2":"HAMBI_1287","3":"0.04","4":"0.1","5":"evo"},{"1":"P06_s_0","2":"HAMBI_1896","3":"0.03","4":"NA","5":"NA"},{"1":"P06_s_0","2":"HAMBI_1977","3":"0.03","4":"NA","5":"NA"},{"1":"P07_s_0","2":"HAMBI_0403","3":"0.71","4":"0.9","5":"evo"},{"1":"P07_s_0","2":"HAMBI_1287","3":"0.02","4":"NA","5":"NA"},{"1":"P07_s_0","2":"HAMBI_1896","3":"0.04","4":"NA","5":"NA"},{"1":"P07_s_0","2":"HAMBI_1977","3":"0.23","4":"0.1","5":"anc"},{"1":"P19_s_0","2":"HAMBI_0403","3":"0.24","4":"NA","5":"NA"},{"1":"P19_s_0","2":"HAMBI_1287","3":"0.28","4":"0.9","5":"evo"},{"1":"P19_s_0","2":"HAMBI_1896","3":"0.44","4":"0.1","5":"anc"},{"1":"P19_s_0","2":"HAMBI_1977","3":"0.04","4":"NA","5":"NA"},{"1":"P20_s_0","2":"HAMBI_0403","3":"0.22","4":"NA","5":"NA"},{"1":"P20_s_0","2":"HAMBI_1287","3":"0.41","4":"0.9","5":"evo"},{"1":"P20_s_0","2":"HAMBI_1896","3":"0.35","4":"0.1","5":"evo"},{"1":"P20_s_0","2":"HAMBI_1977","3":"0.01","4":"NA","5":"NA"},{"1":"P43_s_0","2":"HAMBI_0403","3":"0.01","4":"NA","5":"NA"},{"1":"P43_s_0","2":"HAMBI_1287","3":"0.02","4":"0.1","5":"evo"},{"1":"P43_s_0","2":"HAMBI_1896","3":"0.96","4":"0.9","5":"anc"},{"1":"P43_s_0","2":"HAMBI_1977","3":"0.00","4":"NA","5":"NA"},{"1":"P44_s_0","2":"HAMBI_0403","3":"0.01","4":"NA","5":"NA"},{"1":"P44_s_0","2":"HAMBI_1287","3":"0.03","4":"0.1","5":"evo"},{"1":"P44_s_0","2":"HAMBI_1896","3":"0.96","4":"0.9","5":"evo"},{"1":"P44_s_0","2":"HAMBI_1977","3":"0.01","4":"NA","5":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"masterplate"</span>) <span class="sc">&amp;</span> n_species <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold =</span> <span class="dv">0</span>, <span class="at">quartet =</span> <span class="cn">FALSE</span>, <span class="at">y=</span>f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">ggtitle</span>(<span class="st">"Masterplate pairs with contamination"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-05" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Species composition of masterplate pairs that contain any percentage (&gt; 0%) of a species that shouldn’t be there (shown in grey to black).
</figcaption>
</figure>
</div>
</section>
<section id="trios" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="trios"><span class="header-section-number">5.6.2</span> Trios</h3>
<p>Trio masterplates look quite good. Yes, there are some samples where a species that shouldn’t be there is &gt; 3%, but these are always &lt; 5% and there are no samples with major contamination</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(notes, <span class="st">"trios"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(notes, <span class="st">"masterplate"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold =</span> <span class="fl">0.01</span>, <span class="at">quartet =</span> <span class="cn">FALSE</span>, <span class="at">y=</span>f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">ggtitle</span>(<span class="st">"Masterplate trios with contamination"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-06" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Species composition of masterplate pairs that contain &gt;= 1% of a species that shouldn’t be there (shown in grey to black).
</figcaption>
</figure>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(notes, <span class="st">"trios"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(notes, <span class="st">"masterplate"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="fu">contam_histogram</span>(<span class="at">trans =</span> <span class="cn">FALSE</span>, <span class="at">x =</span> f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species frequency"</span>, <span class="at">y =</span> <span class="st">"Sample count"</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">ggtitle</span>(<span class="st">"Frequency distribution of misassigned species in masterplate trios"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-07" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Frequency distribution of each species in masterplate samples where it <strong>should not</strong> occur. The 1% mark (commonly accepted as an acceptable Illumina cross-talk standard) is demarcated with a dashed line.
</figcaption>
</figure>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(notes, <span class="st">"trios"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(notes, <span class="st">"masterplate"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">contam_histogram</span>(<span class="at">trans =</span> <span class="cn">FALSE</span>, <span class="at">x =</span> f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species frequency"</span>, <span class="at">y =</span> <span class="st">"Sample count"</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>  <span class="fu">ggtitle</span>(<span class="st">"Frequency distribution of focal species in masterplate trios"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-08" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Frequency distribution of each species in all samples where it <strong>should</strong> occur.
</figcaption>
</figure>
</div>
</section>
<section id="quartets" class="level3" data-number="5.6.3">
<h3 data-number="5.6.3" class="anchored" data-anchor-id="quartets"><span class="header-section-number">5.6.3</span> Quartets</h3>
<p>One weakness of this contamination-detection approach is that there is no way to tell from this data whether a quartet masterplate is contaminated because every quartet (by definition) is inoculated with all of the 4 species at different frequencies and with different evolutionary histories. See <a href="#sec-quartets2" class="quarto-xref">Section&nbsp;5.7.3</a> below for more information. However, we can still visualize the composition of those quartets and whether they seem to be close to what we expected to put in.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(notes, <span class="st">"quartets"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(notes, <span class="st">"masterplate"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold =</span> <span class="fl">0.01</span>, <span class="at">quartet =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="fu">ggtitle</span>(<span class="st">"All masterplate quartets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-09" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Species composition of masterplate quartets.
</figcaption>
</figure>
</div>
<p>These look really good and are clearly following the correct pattern/distribution for the quartets.</p>
</section>
</section>
<section id="experimental-samples" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="experimental-samples"><span class="header-section-number">5.7</span> Experimental samples</h2>
<p>We may need to use a higher threshold than 1% (e.g., 3% frequency) because over 3% we can reliably say that a species is present and it is not due to index cross talk.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="fl">0.03</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">contam_histogram</span>(<span class="at">trans=</span><span class="cn">TRUE</span>, <span class="at">x =</span> f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species frequency"</span>, <span class="at">y =</span> <span class="st">"Sample count"</span>) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="fu">ggtitle</span>(<span class="st">"Frequency distribution of each species exceeding the 3% threshold"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-10" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Frequency distribution of each species in experimental samples where it <strong>should not</strong> occur and where it exceeds a 3% threshold.
</figcaption>
</figure>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="co"># there are only experiment samples left</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5"></a>  <span class="fu">filter</span>(f_raw_targetsp <span class="sc">&gt;</span> <span class="fl">0.03</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="#cb27-6"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, strainID, f_raw_targetsp) <span class="sc">%&gt;%</span> </span>
<span id="cb27-7"><a href="#cb27-7"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(f_raw_targetsp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sample"],"name":[1],"type":["chr"],"align":["left"]},{"label":["strainID"],"name":[2],"type":["chr"],"align":["left"]},{"label":["f_raw_targetsp"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"3_p02_C01","2":"HAMBI_1977","3":"0.55340314"},{"1":"3_p01_C12","2":"HAMBI_1287","3":"0.48218632"},{"1":"3_p02_C03","2":"HAMBI_1977","3":"0.06346623"},{"1":"3_p02_E09","2":"HAMBI_1977","3":"0.06280508"},{"1":"3_p02_F09","2":"HAMBI_1977","3":"0.05180940"},{"1":"P44_1_0","2":"HAMBI_1977","3":"0.04705004"},{"1":"3_p02_D05","2":"HAMBI_1977","3":"0.04110390"},{"1":"3_p02_C05","2":"HAMBI_1977","3":"0.04069923"},{"1":"P44_2_0","2":"HAMBI_1977","3":"0.03915915"},{"1":"P43_1_0","2":"HAMBI_1977","3":"0.03584486"},{"1":"3_p02_A05","2":"HAMBI_1977","3":"0.03453820"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>There are 11 samples (2% of 498 samples) that exceed a 3% crosstalk threshold. 9 samples (2% of 498 samples) have contamination &lt;= 8% and 2 samples (0 % of 498 samples) have &gt; 8% of a species that should not be there. In most cases the species in highly contaminated samples is HAMBI_1977. I think these 2 samples are probably at very high risk for legitimate contamination. It is likely that the rest of the 9 samples with &lt;= 8% contamination are not contaminated but just crosstalk outliers.</p>
<section id="pairs-1" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="pairs-1"><span class="header-section-number">5.7.1</span> Pairs</h3>
<p>Here just taking a closer look at the pairs from the experiment that appear to be contaminated.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>) <span class="sc">&amp;</span> n_species <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold =</span> <span class="fl">0.03</span>, <span class="at">quartet =</span> <span class="cn">FALSE</span>, <span class="at">y=</span>f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="fu">ggtitle</span>(<span class="st">"Experiment pairs with &gt; 3% contamination"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-11" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Species composition of pairs masterplates samples that contain &gt; 3% of a species that shouldn’t be there (shown in grey to black).
</figcaption>
</figure>
</div>
<p>All experimental pair samples look pretty good. I think we should only exclude samples where the contamination is very high (over ~50% of the sample) but those with around 10% or less contaminant I think can be retained. So we will not need filter any of these out.</p>
</section>
<section id="trios-1" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="trios-1"><span class="header-section-number">5.7.2</span> Trios</h3>
<p>Here just taking a closer look at the trios from the experiment that appear to be contaminated.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>) <span class="sc">&amp;</span> n_species <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold=</span><span class="fl">0.03</span>, <span class="at">quartet =</span> <span class="cn">FALSE</span>, <span class="at">y=</span>f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="fu">ggtitle</span>(<span class="st">"Experiment trios with &gt; 3% contamination"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-12" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Species composition of experiment trio samples that contain &gt; 3% of a species that shouldn’t be there (shown in grey to black).
</figcaption>
</figure>
</div>
<p>Only 2 trio samples look really bad (over 10 %, more like 50 % contamination). Again, I think we should only exclude samples where the contamination is very high (over ~50% of the sample) but those with around 10% or less contaminant I think can be retained, and I will discard the contaminating sequences.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>contamtrios <span class="ot">&lt;-</span> finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>) <span class="sc">&amp;</span> n_species <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">filter</span>(f_raw_targetsp <span class="sc">&gt;</span> <span class="fl">0.13</span>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="fu">pull</span>(sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sec-quartets2" class="level3" data-number="5.7.3">
<h3 data-number="5.7.3" class="anchored" data-anchor-id="sec-quartets2"><span class="header-section-number">5.7.3</span> Quartets</h3>
<p>Again, one weakness of this approach is that there is no way to tell from this data whether a quartet is contaminated because every quartet (by definition) is inoculated with all of the 4 species at different frequencies and with different evolutionary histories. Thus we would expect to see either all 4 species present or a subset of the 4 species in the quartet samples, but we cannot tell if these patterns come from contamination or not. Moving forward we just have to assume that the quartets are OK… However, we’ve found so little contamination in our other experimental samples and all samples were handled in the experiment and processed for sequence library preparation in the same way. I think it is safe to assume that contamination in the quartets is minimal issue.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">filter</span>(n_species <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="fu">mutate</span>(<span class="at">facet =</span> <span class="fu">ntile</span>(id, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-8"><a href="#cb31-8"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold =</span> <span class="dv">0</span>, <span class="at">quartet =</span> <span class="cn">TRUE</span>, <span class="at">y=</span>f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9"></a>  <span class="fu">ggtitle</span>(<span class="st">"All experimental quartets"</span>) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>facet, <span class="at">scales=</span><span class="st">"free_x"</span>, <span class="at">nrow=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11"></a>  <span class="fu">theme</span>(</span>
<span id="cb31-12"><a href="#cb31-12"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-13"><a href="#cb31-13"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-14"><a href="#cb31-14"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb31-15"><a href="#cb31-15"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-13" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_format_rbec_tab_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Species composition of masterplate quartets.
</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="export" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Export</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>finaltable_exp_mstr_export <span class="ot">&lt;-</span> finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="co"># first remove samples with low read count (&lt; 3000 reads)</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="co"># filter(sample %nin% lowread_samps) %&gt;% </span></span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="co"># next remove masterplate pair samples that were highly contaminated</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="co"># filter(sample %nin% contampairsmaster) %&gt;% </span></span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="co"># remove trio samples that were highly contaminated</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="fu">filter</span>(sample <span class="sc">%nin%</span> contamtrios) <span class="sc">%&gt;%</span> </span>
<span id="cb32-8"><a href="#cb32-8"></a>  <span class="co"># exclude any remaining counts from species that shouldnt be there using again</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>  <span class="co"># the fact that evo_hist should be NA for these species</span></span>
<span id="cb32-10"><a href="#cb32-10"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-11"><a href="#cb32-11"></a>  <span class="co"># because we set 3% as our limit of detection we set read counts of species</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="co"># less than 1% to 0</span></span>
<span id="cb32-13"><a href="#cb32-13"></a>  <span class="fu">mutate</span>(<span class="at">count_correct_thresh =</span> <span class="fu">if_else</span>(f_raw_targetsp <span class="sc">&lt;=</span> <span class="fl">0.03</span>, <span class="dv">0</span>, count_correct)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-14"><a href="#cb32-14"></a>  <span class="co"># now calculate a new relative abundance based only on the species that should</span></span>
<span id="cb32-15"><a href="#cb32-15"></a>  <span class="co"># be present and that are &gt; 3% relative abundance</span></span>
<span id="cb32-16"><a href="#cb32-16"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb32-17"><a href="#cb32-17"></a>  <span class="fu">mutate</span>(<span class="at">f_thresh =</span> count_correct_thresh<span class="sc">/</span><span class="fu">sum</span>(count_correct_thresh)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-18"><a href="#cb32-18"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-19"><a href="#cb32-19"></a>  <span class="co"># for marking which sequencing batch these came from </span></span>
<span id="cb32-20"><a href="#cb32-20"></a>  <span class="fu">mutate</span>(<span class="at">batch =</span> <span class="st">"run202410124"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-21"><a href="#cb32-21"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, strainID, evo_hist, count_correct_thresh, f_thresh,</span>
<span id="cb32-22"><a href="#cb32-22"></a>                <span class="at">target_f_masterplate =</span> target_f, replicate, strep_conc, </span>
<span id="cb32-23"><a href="#cb32-23"></a>                transfers, n_species, community_type, plate_well, batch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="pairs-2" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="pairs-2"><span class="header-section-number">6.1</span> Pairs</h2>
<p>Write the pair samples</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>finaltable_exp_mstr_export <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">filter</span>(n_species <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">arrange</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">write_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"pairs_counts.tsv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="trios-2" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="trios-2"><span class="header-section-number">6.2</span> Trios</h2>
<p>Write the trio samples</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>finaltable_exp_mstr_export <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="fu">filter</span>(n_species <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">arrange</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4"></a>  <span class="fu">write_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"trios_counts.tsv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="quartets-1" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="quartets-1"><span class="header-section-number">6.3</span> Quartets</h2>
<p>Write the quartet samples</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>finaltable_exp_mstr_export <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">filter</span>(n_species <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="fu">arrange</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">write_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"quartets_counts.tsv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb36" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1"></a><span class="co">---</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="an">title:</span><span class="co"> "Formatting Rbec output from 2024-10-20 sequenced by BTK Turku using custom HAMBI Illumina v3 primers"</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="an">author:</span><span class="co"> "Milla Similä &amp; Shane Hogle"</span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="an">link-citations:</span><span class="co"> true</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="an">abstract:</span><span class="co"> "Results from trios and quartets in 0 ug/ml streptomycin concentration and their masterplates from Milla's community assembly experiment. Also includes a couple pairs that failed last time that we redid in this sequencing run."</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="co">---</span></span>
<span id="cb36-8"><a href="#cb36-8"></a></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="fu"># Setup</span></span>
<span id="cb36-10"><a href="#cb36-10"></a></span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="fu">## Libraries</span></span>
<span id="cb36-12"><a href="#cb36-12"></a></span>
<span id="cb36-15"><a href="#cb36-15"></a><span class="in">```{r}</span></span>
<span id="cb36-16"><a href="#cb36-16"></a><span class="co">#| output: false</span></span>
<span id="cb36-17"><a href="#cb36-17"></a><span class="co">#| warning: false</span></span>
<span id="cb36-18"><a href="#cb36-18"></a><span class="co">#| error: false</span></span>
<span id="cb36-19"><a href="#cb36-19"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb36-20"><a href="#cb36-20"></a><span class="fu">library</span>(here)</span>
<span id="cb36-21"><a href="#cb36-21"></a><span class="fu">library</span>(fs)</span>
<span id="cb36-22"><a href="#cb36-22"></a><span class="fu">library</span>(archive)</span>
<span id="cb36-23"><a href="#cb36-23"></a><span class="fu">library</span>(scales)</span>
<span id="cb36-24"><a href="#cb36-24"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils_generic.R"</span>))</span>
<span id="cb36-25"><a href="#cb36-25"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"communities"</span>, <span class="st">"community_composition"</span>, <span class="st">"amplicon"</span>, <span class="st">"utils_amplicon.R"</span>))</span>
<span id="cb36-26"><a href="#cb36-26"></a><span class="in">```</span></span>
<span id="cb36-27"><a href="#cb36-27"></a></span>
<span id="cb36-28"><a href="#cb36-28"></a><span class="fu">## Global variables</span></span>
<span id="cb36-29"><a href="#cb36-29"></a></span>
<span id="cb36-32"><a href="#cb36-32"></a><span class="in">```{r}</span></span>
<span id="cb36-33"><a href="#cb36-33"></a><span class="co">#| output: false</span></span>
<span id="cb36-34"><a href="#cb36-34"></a><span class="co">#| warning: false</span></span>
<span id="cb36-35"><a href="#cb36-35"></a><span class="co">#| error: false</span></span>
<span id="cb36-36"><a href="#cb36-36"></a>data_raw <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_data_raw"</span>, <span class="st">"communities"</span>, <span class="st">"20241024_BTK_illumina_v3"</span>)</span>
<span id="cb36-37"><a href="#cb36-37"></a>data <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"communities"</span>, <span class="st">"20241024_BTK_illumina_v3"</span>)</span>
<span id="cb36-38"><a href="#cb36-38"></a>amplicontar <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(data_raw, <span class="st">"rbec_output.tar.gz"</span>)</span>
<span id="cb36-39"><a href="#cb36-39"></a></span>
<span id="cb36-40"><a href="#cb36-40"></a><span class="co"># make processed data directory if it doesn't exist</span></span>
<span id="cb36-41"><a href="#cb36-41"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(data)</span>
<span id="cb36-42"><a href="#cb36-42"></a></span>
<span id="cb36-43"><a href="#cb36-43"></a><span class="co"># create temporary location to decompress</span></span>
<span id="cb36-44"><a href="#cb36-44"></a>tmpdir <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">file_temp</span>()</span>
<span id="cb36-45"><a href="#cb36-45"></a><span class="in">```</span></span>
<span id="cb36-46"><a href="#cb36-46"></a></span>
<span id="cb36-47"><a href="#cb36-47"></a><span class="fu"># Read metadata</span></span>
<span id="cb36-48"><a href="#cb36-48"></a></span>
<span id="cb36-51"><a href="#cb36-51"></a><span class="in">```{r}</span></span>
<span id="cb36-52"><a href="#cb36-52"></a><span class="co">#| output: false</span></span>
<span id="cb36-53"><a href="#cb36-53"></a><span class="co">#| warning: false</span></span>
<span id="cb36-54"><a href="#cb36-54"></a><span class="co">#| error: false</span></span>
<span id="cb36-55"><a href="#cb36-55"></a>mddf <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_raw, <span class="st">"20241024_BTK_illumina_v3_metadata.tsv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-56"><a href="#cb36-56"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">str_trim</span>(sample))</span>
<span id="cb36-57"><a href="#cb36-57"></a>spdf <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_raw, <span class="st">"sample_compositions.tsv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-58"><a href="#cb36-58"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">str_trim</span>(sample))</span>
<span id="cb36-59"><a href="#cb36-59"></a><span class="in">```</span></span>
<span id="cb36-60"><a href="#cb36-60"></a></span>
<span id="cb36-61"><a href="#cb36-61"></a><span class="fu"># Read Rbec raw counts tables </span></span>
<span id="cb36-62"><a href="#cb36-62"></a></span>
<span id="cb36-63"><a href="#cb36-63"></a><span class="fu">## Untar Rbec output tarball</span></span>
<span id="cb36-64"><a href="#cb36-64"></a></span>
<span id="cb36-67"><a href="#cb36-67"></a><span class="in">```{r}</span></span>
<span id="cb36-68"><a href="#cb36-68"></a>archive<span class="sc">::</span><span class="fu">archive_extract</span>(</span>
<span id="cb36-69"><a href="#cb36-69"></a>  amplicontar,</span>
<span id="cb36-70"><a href="#cb36-70"></a>  <span class="at">dir =</span> tmpdir,</span>
<span id="cb36-71"><a href="#cb36-71"></a>  <span class="at">files =</span> <span class="cn">NULL</span>,</span>
<span id="cb36-72"><a href="#cb36-72"></a>  <span class="at">options =</span> <span class="fu">character</span>(),</span>
<span id="cb36-73"><a href="#cb36-73"></a>  <span class="at">strip_components =</span> <span class="dv">0</span>L</span>
<span id="cb36-74"><a href="#cb36-74"></a>)</span>
<span id="cb36-75"><a href="#cb36-75"></a><span class="in">```</span></span>
<span id="cb36-76"><a href="#cb36-76"></a></span>
<span id="cb36-77"><a href="#cb36-77"></a><span class="fu">## Setup directory structure</span></span>
<span id="cb36-78"><a href="#cb36-78"></a></span>
<span id="cb36-81"><a href="#cb36-81"></a><span class="in">```{r}</span></span>
<span id="cb36-82"><a href="#cb36-82"></a>tabdir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(tmpdir, <span class="st">"rbec_output"</span>)</span>
<span id="cb36-83"><a href="#cb36-83"></a>samppaths <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(tabdir)</span>
<span id="cb36-84"><a href="#cb36-84"></a>sampnames <span class="ot">&lt;-</span> <span class="fu">path_split</span>(samppaths) <span class="sc">%&gt;%</span> </span>
<span id="cb36-85"><a href="#cb36-85"></a>  <span class="fu">map_chr</span>(dplyr<span class="sc">::</span>last)</span>
<span id="cb36-86"><a href="#cb36-86"></a><span class="in">```</span></span>
<span id="cb36-87"><a href="#cb36-87"></a></span>
<span id="cb36-88"><a href="#cb36-88"></a><span class="fu">## Read</span></span>
<span id="cb36-89"><a href="#cb36-89"></a></span>
<span id="cb36-92"><a href="#cb36-92"></a><span class="in">```{r}</span></span>
<span id="cb36-93"><a href="#cb36-93"></a>straintabs <span class="ot">&lt;-</span> <span class="fu">paste0</span>(samppaths, <span class="st">"/strain_table.txt"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-94"><a href="#cb36-94"></a>  <span class="fu">set_names</span>(sampnames) <span class="sc">%&gt;%</span> </span>
<span id="cb36-95"><a href="#cb36-95"></a>  <span class="fu">map_df</span>(</span>
<span id="cb36-96"><a href="#cb36-96"></a>  read_tsv,</span>
<span id="cb36-97"><a href="#cb36-97"></a>  <span class="at">skip =</span> <span class="dv">1</span>,</span>
<span id="cb36-98"><a href="#cb36-98"></a>  <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"rRNA16S_locus"</span>,<span class="st">"count"</span>),</span>
<span id="cb36-99"><a href="#cb36-99"></a>  <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, </span>
<span id="cb36-100"><a href="#cb36-100"></a>  <span class="at">.id =</span> <span class="st">"sample"</span>)</span>
<span id="cb36-101"><a href="#cb36-101"></a><span class="in">```</span></span>
<span id="cb36-102"><a href="#cb36-102"></a></span>
<span id="cb36-103"><a href="#cb36-103"></a><span class="fu">## Clean up</span></span>
<span id="cb36-104"><a href="#cb36-104"></a></span>
<span id="cb36-107"><a href="#cb36-107"></a><span class="in">```{r}</span></span>
<span id="cb36-108"><a href="#cb36-108"></a><span class="co"># remove decompressed directory from temp location</span></span>
<span id="cb36-109"><a href="#cb36-109"></a>fs<span class="sc">::</span><span class="fu">dir_delete</span>(tmpdir)</span>
<span id="cb36-110"><a href="#cb36-110"></a><span class="in">```</span></span>
<span id="cb36-111"><a href="#cb36-111"></a></span>
<span id="cb36-112"><a href="#cb36-112"></a><span class="fu"># Format</span></span>
<span id="cb36-113"><a href="#cb36-113"></a></span>
<span id="cb36-116"><a href="#cb36-116"></a><span class="in">```{r}</span></span>
<span id="cb36-117"><a href="#cb36-117"></a>straintabs_norm <span class="ot">&lt;-</span> straintabs <span class="sc">%&gt;%</span> </span>
<span id="cb36-118"><a href="#cb36-118"></a>  <span class="co"># Calls function that normalize counts by 16S copy number</span></span>
<span id="cb36-119"><a href="#cb36-119"></a>  <span class="fu">normalize_by_copy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-120"><a href="#cb36-120"></a>  <span class="co"># Calls function that completes all combinations of 23 species</span></span>
<span id="cb36-121"><a href="#cb36-121"></a>  <span class="co"># this is important because some species go extinct that should be in the samples</span></span>
<span id="cb36-122"><a href="#cb36-122"></a>  <span class="co"># and we need to have those in the final table</span></span>
<span id="cb36-123"><a href="#cb36-123"></a>  <span class="fu">complete_combos</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-124"><a href="#cb36-124"></a>  <span class="co"># removes any extra whitespace on sample names</span></span>
<span id="cb36-125"><a href="#cb36-125"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">str_trim</span>(sample))</span>
<span id="cb36-126"><a href="#cb36-126"></a><span class="in">```</span></span>
<span id="cb36-127"><a href="#cb36-127"></a></span>
<span id="cb36-128"><a href="#cb36-128"></a>Make final table</span>
<span id="cb36-129"><a href="#cb36-129"></a></span>
<span id="cb36-132"><a href="#cb36-132"></a><span class="in">```{r}</span></span>
<span id="cb36-133"><a href="#cb36-133"></a><span class="co"># Later we will take advantage of the fact that for species not supposed to be</span></span>
<span id="cb36-134"><a href="#cb36-134"></a><span class="co"># in a sample the prior left_join will have filled the evo_hist category with an</span></span>
<span id="cb36-135"><a href="#cb36-135"></a><span class="co"># NA. We can then filter using this NA value</span></span>
<span id="cb36-136"><a href="#cb36-136"></a>finaltable <span class="ot">&lt;-</span> <span class="fu">left_join</span>(straintabs_norm, mddf, <span class="at">by =</span> <span class="fu">join_by</span>(sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-137"><a href="#cb36-137"></a>  <span class="fu">left_join</span>(spdf, <span class="at">by =</span> <span class="fu">join_by</span>(sample, strainID)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-138"><a href="#cb36-138"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb36-139"><a href="#cb36-139"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>genus, <span class="sc">-</span>species) <span class="sc">%&gt;%</span> </span>
<span id="cb36-140"><a href="#cb36-140"></a>  <span class="fu">mutate</span>(<span class="at">f_raw =</span> count_correct<span class="sc">/</span><span class="fu">sum</span>(count_correct),</span>
<span id="cb36-141"><a href="#cb36-141"></a>         <span class="at">sample_tot_raw =</span> <span class="fu">sum</span>(count_correct)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-142"><a href="#cb36-142"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-143"><a href="#cb36-143"></a>  <span class="fu">relocate</span>(sample_tot_raw, f_raw, target_f, evo_hist, <span class="at">.after =</span> count_correct) <span class="sc">%&gt;%</span> </span>
<span id="cb36-144"><a href="#cb36-144"></a>  <span class="co"># reformats sample names for pairs so that they are same as in the the batch from</span></span>
<span id="cb36-145"><a href="#cb36-145"></a>  <span class="co"># 20240711</span></span>
<span id="cb36-146"><a href="#cb36-146"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">case_when</span>(n_species <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> notes, </span>
<span id="cb36-147"><a href="#cb36-147"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> sample))</span>
<span id="cb36-148"><a href="#cb36-148"></a><span class="in">```</span></span>
<span id="cb36-149"><a href="#cb36-149"></a></span>
<span id="cb36-150"><a href="#cb36-150"></a><span class="fu"># Analysis</span></span>
<span id="cb36-151"><a href="#cb36-151"></a></span>
<span id="cb36-152"><a href="#cb36-152"></a>Let's quickly compare and look the at number of reads from the different kinds of experiment categories. Negative controls are samples from the experiment that contained growth medium but no cells. We included them to make sure that there was not contamination between wells during the experiment. Positive controls contain a mixsture of all 23 species (not sure why this was done), and some wells are just empty but were processed/sequenced anyway for convenience of the person preparing the libraries. Experiment samples are those that came from the actual experiment, and masterplate samples are the defined mixtures we made to inoculate the experiment. We sequenced these masterplates so that we would have T0 information for each experimental treatment.</span>
<span id="cb36-153"><a href="#cb36-153"></a></span>
<span id="cb36-154"><a href="#cb36-154"></a>::: {#fig-01}</span>
<span id="cb36-157"><a href="#cb36-157"></a><span class="in">```{r}</span></span>
<span id="cb36-158"><a href="#cb36-158"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-159"><a href="#cb36-159"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb36-160"><a href="#cb36-160"></a>finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb36-161"><a href="#cb36-161"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, sample_tot_raw, community_type) <span class="sc">%&gt;%</span> </span>
<span id="cb36-162"><a href="#cb36-162"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-163"><a href="#cb36-163"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_tot_raw)) <span class="sc">+</span></span>
<span id="cb36-164"><a href="#cb36-164"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="fu">aes</span>(<span class="at">fill =</span> community_type)) <span class="sc">+</span></span>
<span id="cb36-165"><a href="#cb36-165"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> </span>
<span id="cb36-166"><a href="#cb36-166"></a>  <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"b"</span>, <span class="at">color=</span><span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb36-167"><a href="#cb36-167"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Sample count"</span>, <span class="at">x =</span> <span class="st">"Total reads per sample"</span>) <span class="sc">+</span></span>
<span id="cb36-168"><a href="#cb36-168"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> community_type, <span class="at">scales=</span><span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb36-169"><a href="#cb36-169"></a><span class="in">```</span></span>
<span id="cb36-170"><a href="#cb36-170"></a>Frequency distribution of total read counts per sample in the experimental samples (red) and the negative controls (blue).</span>
<span id="cb36-171"><a href="#cb36-171"></a>:::</span>
<span id="cb36-172"><a href="#cb36-172"></a></span>
<span id="cb36-173"><a href="#cb36-173"></a>The smallest number of reads in the experimental samples is <span class="in">`{r} min(finaltable[ grep("^exp", finaltable$community_type), ]$sample_tot_raw)`</span> and the mean is <span class="in">`{r} format(mean(finaltable[ grep("^exp", finaltable$community_type), ]$sample_tot_raw), scientific=FALSE)`</span> which is considerably more than the smallest number of reads <span class="in">`{r} min(finaltable[ grep("^neg", finaltable$community_type), ]$sample_tot_raw)`</span> and the mean <span class="in">`{r} mean(finaltable[ grep("^neg", finaltable$community_type), ]$sample_tot_raw)`</span> in the negative controls.</span>
<span id="cb36-174"><a href="#cb36-174"></a></span>
<span id="cb36-175"><a href="#cb36-175"></a>This looks really good. The number of reads in the negative controls are always very low (similar to "empty" samples and always an order of magnitude less than masterplates and experimental samples). The number of reads in the negative controls will depend on the sequencing depth used and in this batch compared to the first one with pairs we have used a higher sequencing depth (or less multiplexing) so that the average number of reads is higher here. </span>
<span id="cb36-176"><a href="#cb36-176"></a></span>
<span id="cb36-177"><a href="#cb36-177"></a><span class="fu">## Negative controls</span></span>
<span id="cb36-178"><a href="#cb36-178"></a></span>
<span id="cb36-179"><a href="#cb36-179"></a>First, we’ll check whether the experimental and plate negative controls look good</span>
<span id="cb36-180"><a href="#cb36-180"></a></span>
<span id="cb36-181"><a href="#cb36-181"></a>Lets check what species are contaminating negative controls. Most appear to be low abundance contaminants of species excluded from the experiment. Probably this is cross talk from the positive controls and other samples</span>
<span id="cb36-182"><a href="#cb36-182"></a></span>
<span id="cb36-183"><a href="#cb36-183"></a>::: {#fig-02}</span>
<span id="cb36-186"><a href="#cb36-186"></a><span class="in">```{r}</span></span>
<span id="cb36-187"><a href="#cb36-187"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-188"><a href="#cb36-188"></a><span class="co">#| fig.height: 7</span></span>
<span id="cb36-189"><a href="#cb36-189"></a>finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb36-190"><a href="#cb36-190"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"^neg"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-191"><a href="#cb36-191"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-192"><a href="#cb36-192"></a>  <span class="fu">contam_histogram</span>(<span class="at">trans=</span><span class="cn">TRUE</span>, <span class="at">x =</span> f_raw) <span class="sc">+</span></span>
<span id="cb36-193"><a href="#cb36-193"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Frequency distribution of each species in the negative controls"</span>, <span class="at">y =</span> <span class="st">"Sample count"</span>) <span class="sc">+</span></span>
<span id="cb36-194"><a href="#cb36-194"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>strainID)</span>
<span id="cb36-195"><a href="#cb36-195"></a><span class="in">```</span></span>
<span id="cb36-196"><a href="#cb36-196"></a>Frequency distribution of all species in the negative controls</span>
<span id="cb36-197"><a href="#cb36-197"></a>:::</span>
<span id="cb36-198"><a href="#cb36-198"></a></span>
<span id="cb36-199"><a href="#cb36-199"></a>::: {#fig-03}</span>
<span id="cb36-202"><a href="#cb36-202"></a><span class="in">```{r}</span></span>
<span id="cb36-203"><a href="#cb36-203"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-204"><a href="#cb36-204"></a><span class="co">#| fig.height: 3</span></span>
<span id="cb36-205"><a href="#cb36-205"></a>finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb36-206"><a href="#cb36-206"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"^neg"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-207"><a href="#cb36-207"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(strainID, <span class="st">"0403|1287|1896|1977"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-208"><a href="#cb36-208"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-209"><a href="#cb36-209"></a>  <span class="fu">contam_histogram</span>(<span class="at">trans=</span><span class="cn">TRUE</span>, <span class="at">x =</span> f_raw) <span class="sc">+</span></span>
<span id="cb36-210"><a href="#cb36-210"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Frequency distribution of each species in the negative controls"</span>, <span class="at">y =</span> <span class="st">"Sample count"</span>)</span>
<span id="cb36-211"><a href="#cb36-211"></a><span class="in">```</span></span>
<span id="cb36-212"><a href="#cb36-212"></a>Frequency distribution of only target target species in the negative controls</span>
<span id="cb36-213"><a href="#cb36-213"></a>:::</span>
<span id="cb36-214"><a href="#cb36-214"></a></span>
<span id="cb36-215"><a href="#cb36-215"></a><span class="co">&lt;!-- Again, I think this is really good. Negative controls are strange to sequence because they have such low biomass usually and then weird things can happen with the PCRs in the library preparation stages. However, let’s make sure negative control samples have low OD600 in the endpoint samples. This would indicate growth and that what we are seeing in the histograms is truly just a sequencing artifact --&gt;</span></span>
<span id="cb36-216"><a href="#cb36-216"></a></span>
<span id="cb36-219"><a href="#cb36-219"></a><span class="in">```{r}</span></span>
<span id="cb36-220"><a href="#cb36-220"></a><span class="co">#| output: false</span></span>
<span id="cb36-221"><a href="#cb36-221"></a><span class="co">#| warning: false</span></span>
<span id="cb36-222"><a href="#cb36-222"></a><span class="co">#| error: false</span></span>
<span id="cb36-223"><a href="#cb36-223"></a>od <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_data_raw"</span>, <span class="st">"communities"</span>, <span class="st">"optical_density"</span>, <span class="st">"20240829_tqs"</span>, <span class="st">"optical_density_formatted_102024.txt"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-224"><a href="#cb36-224"></a>  <span class="fu">mutate</span>(<span class="at">well =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(well,</span>
<span id="cb36-225"><a href="#cb36-225"></a>                     <span class="at">pattern =</span> <span class="st">"([0-9]+)"</span>, </span>
<span id="cb36-226"><a href="#cb36-226"></a>                     <span class="at">replacement =</span> {\(x) stringr<span class="sc">::</span><span class="fu">str_pad</span>(<span class="at">string =</span> x, <span class="at">width =</span> <span class="dv">2</span>,  <span class="at">side =</span> <span class="st">"left"</span>,  <span class="at">pad =</span> <span class="st">"0"</span>)}))</span>
<span id="cb36-227"><a href="#cb36-227"></a><span class="in">```</span></span>
<span id="cb36-228"><a href="#cb36-228"></a></span>
<span id="cb36-229"><a href="#cb36-229"></a>All negative control have very low OD &lt; 0.1 and it is safe to assume that they are clean.</span>
<span id="cb36-230"><a href="#cb36-230"></a></span>
<span id="cb36-233"><a href="#cb36-233"></a><span class="in">```{r}</span></span>
<span id="cb36-234"><a href="#cb36-234"></a>df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(finaltable, od, <span class="at">by =</span> <span class="fu">join_by</span>(sample, transfers<span class="sc">==</span>transfer, replicate, strep_conc)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-235"><a href="#cb36-235"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"^neg"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-236"><a href="#cb36-236"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, OD, well, community_type, n_species.x, n_species.y, replicate) <span class="sc">%&gt;%</span> </span>
<span id="cb36-237"><a href="#cb36-237"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-238"><a href="#cb36-238"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(OD))</span>
<span id="cb36-239"><a href="#cb36-239"></a><span class="in">```</span></span>
<span id="cb36-240"><a href="#cb36-240"></a></span>
<span id="cb36-241"><a href="#cb36-241"></a>All negative control have very low OD &lt; 0.1 and low read counts it is safe to assume that they are clean.</span>
<span id="cb36-242"><a href="#cb36-242"></a></span>
<span id="cb36-243"><a href="#cb36-243"></a>::: {#fig-04}</span>
<span id="cb36-246"><a href="#cb36-246"></a><span class="in">```{r}</span></span>
<span id="cb36-247"><a href="#cb36-247"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-248"><a href="#cb36-248"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb36-249"><a href="#cb36-249"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb36-250"><a href="#cb36-250"></a>  <span class="fu">left_join</span>(finaltable, <span class="at">by =</span> <span class="fu">join_by</span>(sample, community_type, replicate, n_species.x<span class="sc">==</span>n_species)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-251"><a href="#cb36-251"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-252"><a href="#cb36-252"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(strainID, <span class="st">"0403|1287|1896|1977"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-253"><a href="#cb36-253"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_tot_raw, sample, OD, community_type) <span class="sc">%&gt;%</span> </span>
<span id="cb36-254"><a href="#cb36-254"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-255"><a href="#cb36-255"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="sc">-</span>sample, <span class="sc">-</span>community_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-256"><a href="#cb36-256"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb36-257"><a href="#cb36-257"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb36-258"><a href="#cb36-258"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">"free_x"</span>)</span>
<span id="cb36-259"><a href="#cb36-259"></a><span class="in">```</span></span>
<span id="cb36-260"><a href="#cb36-260"></a>Optical density (OD) and total read count distributions of negative controls.</span>
<span id="cb36-261"><a href="#cb36-261"></a>:::</span>
<span id="cb36-262"><a href="#cb36-262"></a></span>
<span id="cb36-263"><a href="#cb36-263"></a><span class="fu">## Positive controls</span></span>
<span id="cb36-264"><a href="#cb36-264"></a></span>
<span id="cb36-265"><a href="#cb36-265"></a>The positive community controls should each have all 23 species.</span>
<span id="cb36-266"><a href="#cb36-266"></a></span>
<span id="cb36-269"><a href="#cb36-269"></a><span class="in">```{r}</span></span>
<span id="cb36-270"><a href="#cb36-270"></a>finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb36-271"><a href="#cb36-271"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"^pos"</span>) <span class="sc">&amp;</span> count_correct <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-272"><a href="#cb36-272"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span></span>
<span id="cb36-273"><a href="#cb36-273"></a>  <span class="fu">mutate</span>(<span class="at">n_sp_detected =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb36-274"><a href="#cb36-274"></a>  <span class="fu">distinct</span>(sample, sample_tot_raw, n_sp_detected)</span>
<span id="cb36-275"><a href="#cb36-275"></a><span class="in">```</span></span>
<span id="cb36-276"><a href="#cb36-276"></a>2/3 community controls have plenty of reads and look normal. One has under 1000 reads in total and it only contains the 4 focal species (0403, 1287, 1896, 1977). It looks to me that this could be a mislabeled negative control?</span>
<span id="cb36-277"><a href="#cb36-277"></a></span>
<span id="cb36-278"><a href="#cb36-278"></a><span class="fu">## Misassigned reads</span></span>
<span id="cb36-279"><a href="#cb36-279"></a></span>
<span id="cb36-280"><a href="#cb36-280"></a>These libraries were only prepared with samples containing HAMBI_0403, HAMBI_1287, HAMBI_1896, and HAMBI_1977 so any time species other than these show up is just an incorrect assignment by Rbec or index leakage/crosstalk from the positive community controls. Let's check quickly how many of these there are...</span>
<span id="cb36-281"><a href="#cb36-281"></a></span>
<span id="cb36-284"><a href="#cb36-284"></a><span class="in">```{r}</span></span>
<span id="cb36-285"><a href="#cb36-285"></a>finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb36-286"><a href="#cb36-286"></a>  <span class="co"># filter out community controls since they have all hambi species</span></span>
<span id="cb36-287"><a href="#cb36-287"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"4_p09_A01"</span>, <span class="st">"4_p10_A01"</span>, <span class="st">"4m_p18_A01"</span> ))) <span class="sc">%&gt;%</span> </span>
<span id="cb36-288"><a href="#cb36-288"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(strainID, <span class="st">"0403|1287|1896|1977"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-289"><a href="#cb36-289"></a>  <span class="fu">filter</span>(count_correct <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-290"><a href="#cb36-290"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count_correct))</span>
<span id="cb36-291"><a href="#cb36-291"></a><span class="in">```</span></span>
<span id="cb36-292"><a href="#cb36-292"></a></span>
<span id="cb36-293"><a href="#cb36-293"></a>there are only very small number of reads mapping to off-target species per experimental sample probably from crosstalk leakage.</span>
<span id="cb36-294"><a href="#cb36-294"></a></span>
<span id="cb36-295"><a href="#cb36-295"></a><span class="fu">## Samples with few total reads</span></span>
<span id="cb36-296"><a href="#cb36-296"></a></span>
<span id="cb36-297"><a href="#cb36-297"></a>Some of the experimental pairs had streptomycin concentrations higher than any of the species individually could tolerate. We would expect then that no species would grow successfully in these samples and that the overall biomass would be very low, thus resulting in a low number of recovered reads from these samples.</span>
<span id="cb36-298"><a href="#cb36-298"></a></span>
<span id="cb36-299"><a href="#cb36-299"></a>To look into this. first let’s check which samples have very low OD600 in the endpoint samples. We’ll filter out samples with an OD of less than 0.1 and also samples with fewer than 1000 reads. It is generally good practice to exclude samples with low number of reads.</span>
<span id="cb36-300"><a href="#cb36-300"></a></span>
<span id="cb36-303"><a href="#cb36-303"></a><span class="in">```{r}</span></span>
<span id="cb36-304"><a href="#cb36-304"></a><span class="fu">left_join</span>(finaltable, od, </span>
<span id="cb36-305"><a href="#cb36-305"></a>          <span class="at">by =</span> <span class="fu">join_by</span>(sample, transfers<span class="sc">==</span>transfer, replicate, strep_conc)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-306"><a href="#cb36-306"></a>  <span class="fu">filter</span>(transfers <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-307"><a href="#cb36-307"></a>  <span class="fu">filter</span>(OD <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">|</span> sample_tot_raw <span class="sc">&lt;</span> <span class="dv">3000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-308"><a href="#cb36-308"></a>  <span class="fu">distinct</span>(sample, community_type, OD, sample_tot_raw) <span class="sc">%&gt;%</span> </span>
<span id="cb36-309"><a href="#cb36-309"></a>  <span class="fu">count</span>(community_type)</span>
<span id="cb36-310"><a href="#cb36-310"></a><span class="in">```</span></span>
<span id="cb36-311"><a href="#cb36-311"></a></span>
<span id="cb36-312"><a href="#cb36-312"></a>Samples with low reads or low OD are all negative controls or the one positive control that failed (plus another positive control <span class="in">`4_p10_A01`</span> but this must be from mislabeling because there were no positive controls actually on the experimental plates). </span>
<span id="cb36-313"><a href="#cb36-313"></a></span>
<span id="cb36-314"><a href="#cb36-314"></a><span class="fu">## Filter to target species</span></span>
<span id="cb36-315"><a href="#cb36-315"></a></span>
<span id="cb36-316"><a href="#cb36-316"></a>Exclude positive and negative controls and also exclude species that are not in the focal 4</span>
<span id="cb36-317"><a href="#cb36-317"></a></span>
<span id="cb36-320"><a href="#cb36-320"></a><span class="in">```{r}</span></span>
<span id="cb36-321"><a href="#cb36-321"></a>finaltable_exp_mstr <span class="ot">&lt;-</span> finaltable <span class="sc">%&gt;%</span> </span>
<span id="cb36-322"><a href="#cb36-322"></a>  <span class="fu">filter</span>(community_type <span class="sc">%nin%</span> <span class="fu">c</span>(<span class="st">"empty"</span>, <span class="st">"neg_control"</span>, <span class="st">"pos_control"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-323"><a href="#cb36-323"></a>  <span class="co"># no low-read samples to filter</span></span>
<span id="cb36-324"><a href="#cb36-324"></a>  <span class="co">#filter(sample %nin% lowread_samps) %&gt;% </span></span>
<span id="cb36-325"><a href="#cb36-325"></a>  <span class="fu">filter</span>(strainID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"HAMBI_0403"</span>, <span class="st">"HAMBI_1287"</span>, <span class="st">"HAMBI_1896"</span>, <span class="st">"HAMBI_1977"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-326"><a href="#cb36-326"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb36-327"><a href="#cb36-327"></a>  <span class="fu">mutate</span>(<span class="at">f_raw_targetsp =</span> count_correct<span class="sc">/</span><span class="fu">sum</span>(count_correct),</span>
<span id="cb36-328"><a href="#cb36-328"></a>         <span class="at">sample_tot_targetsp =</span> <span class="fu">sum</span>(count_correct)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-329"><a href="#cb36-329"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-330"><a href="#cb36-330"></a>  <span class="fu">relocate</span>(<span class="fu">c</span>(sample_tot_targetsp, f_raw_targetsp), <span class="at">.after =</span> f_raw)</span>
<span id="cb36-331"><a href="#cb36-331"></a><span class="in">```</span></span>
<span id="cb36-332"><a href="#cb36-332"></a></span>
<span id="cb36-333"><a href="#cb36-333"></a><span class="fu">## Masterplate samples</span></span>
<span id="cb36-334"><a href="#cb36-334"></a></span>
<span id="cb36-335"><a href="#cb36-335"></a><span class="fu">### Pairs</span></span>
<span id="cb36-336"><a href="#cb36-336"></a></span>
<span id="cb36-337"><a href="#cb36-337"></a>Something a bit weird is going on with two of the masterplate pairs. Samples P19 and P20 both somehow have ~20 of HAMBI_0403 present in them. However, the rest of the species composition looks like how we expect them. I think we will keep these two masterplate samples and just filter out the HAMBI_0403 that shouldn't be there</span>
<span id="cb36-338"><a href="#cb36-338"></a></span>
<span id="cb36-341"><a href="#cb36-341"></a><span class="in">```{r}</span></span>
<span id="cb36-342"><a href="#cb36-342"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb36-343"><a href="#cb36-343"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"masterplate"</span>) <span class="sc">&amp;</span> n_species <span class="sc">==</span> <span class="dv">2</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb36-344"><a href="#cb36-344"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, strainID, f_raw_targetsp, target_f, evo_hist) <span class="sc">%&gt;%</span> </span>
<span id="cb36-345"><a href="#cb36-345"></a>  <span class="fu">mutate</span>(<span class="at">f_raw_targetsp =</span> <span class="fu">round</span>(f_raw_targetsp, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-346"><a href="#cb36-346"></a>  <span class="fu">distinct</span>()</span>
<span id="cb36-347"><a href="#cb36-347"></a><span class="in">```</span></span>
<span id="cb36-348"><a href="#cb36-348"></a></span>
<span id="cb36-349"><a href="#cb36-349"></a>::: {#fig-05}</span>
<span id="cb36-352"><a href="#cb36-352"></a><span class="in">```{r}</span></span>
<span id="cb36-353"><a href="#cb36-353"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-354"><a href="#cb36-354"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb36-355"><a href="#cb36-355"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb36-356"><a href="#cb36-356"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"masterplate"</span>) <span class="sc">&amp;</span> n_species <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-357"><a href="#cb36-357"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold =</span> <span class="dv">0</span>, <span class="at">quartet =</span> <span class="cn">FALSE</span>, <span class="at">y=</span>f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb36-358"><a href="#cb36-358"></a>  <span class="fu">ggtitle</span>(<span class="st">"Masterplate pairs with contamination"</span>)</span>
<span id="cb36-359"><a href="#cb36-359"></a><span class="in">```</span></span>
<span id="cb36-360"><a href="#cb36-360"></a>Species composition of masterplate pairs that contain any percentage (&gt; 0%) of a species that shouldn’t be there (shown in grey to black).</span>
<span id="cb36-361"><a href="#cb36-361"></a>:::</span>
<span id="cb36-362"><a href="#cb36-362"></a></span>
<span id="cb36-363"><a href="#cb36-363"></a><span class="fu">### Trios</span></span>
<span id="cb36-364"><a href="#cb36-364"></a></span>
<span id="cb36-365"><a href="#cb36-365"></a>Trio masterplates look quite good. Yes, there are some samples where a species that shouldn't be there is &gt; 3%, but these are always &lt; 5% and there are no samples with major contamination </span>
<span id="cb36-366"><a href="#cb36-366"></a></span>
<span id="cb36-367"><a href="#cb36-367"></a>::: {#fig-06}</span>
<span id="cb36-370"><a href="#cb36-370"></a><span class="in">```{r}</span></span>
<span id="cb36-371"><a href="#cb36-371"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-372"><a href="#cb36-372"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb36-373"><a href="#cb36-373"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb36-374"><a href="#cb36-374"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(notes, <span class="st">"trios"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(notes, <span class="st">"masterplate"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-375"><a href="#cb36-375"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold =</span> <span class="fl">0.01</span>, <span class="at">quartet =</span> <span class="cn">FALSE</span>, <span class="at">y=</span>f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb36-376"><a href="#cb36-376"></a>  <span class="fu">ggtitle</span>(<span class="st">"Masterplate trios with contamination"</span>)</span>
<span id="cb36-377"><a href="#cb36-377"></a><span class="in">```</span></span>
<span id="cb36-378"><a href="#cb36-378"></a>Species composition of masterplate pairs that contain &gt;= 1% of a species that shouldn’t be there (shown in grey to black).</span>
<span id="cb36-379"><a href="#cb36-379"></a>:::</span>
<span id="cb36-380"><a href="#cb36-380"></a></span>
<span id="cb36-381"><a href="#cb36-381"></a>::: {#fig-07}</span>
<span id="cb36-384"><a href="#cb36-384"></a><span class="in">```{r}</span></span>
<span id="cb36-385"><a href="#cb36-385"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-386"><a href="#cb36-386"></a><span class="co">#| fig.height: 4</span></span>
<span id="cb36-387"><a href="#cb36-387"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb36-388"><a href="#cb36-388"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(notes, <span class="st">"trios"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(notes, <span class="st">"masterplate"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-389"><a href="#cb36-389"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-390"><a href="#cb36-390"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-391"><a href="#cb36-391"></a>  <span class="fu">contam_histogram</span>(<span class="at">trans =</span> <span class="cn">FALSE</span>, <span class="at">x =</span> f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb36-392"><a href="#cb36-392"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species frequency"</span>, <span class="at">y =</span> <span class="st">"Sample count"</span>) <span class="sc">+</span></span>
<span id="cb36-393"><a href="#cb36-393"></a>  <span class="fu">ggtitle</span>(<span class="st">"Frequency distribution of misassigned species in masterplate trios"</span>)</span>
<span id="cb36-394"><a href="#cb36-394"></a><span class="in">```</span></span>
<span id="cb36-395"><a href="#cb36-395"></a>Frequency distribution of each species in masterplate samples where it **should not** occur. The 1% mark (commonly accepted as an acceptable Illumina cross-talk standard) is demarcated with a dashed line. </span>
<span id="cb36-396"><a href="#cb36-396"></a>:::</span>
<span id="cb36-397"><a href="#cb36-397"></a></span>
<span id="cb36-398"><a href="#cb36-398"></a>::: {#fig-08}</span>
<span id="cb36-401"><a href="#cb36-401"></a><span class="in">```{r}</span></span>
<span id="cb36-402"><a href="#cb36-402"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-403"><a href="#cb36-403"></a><span class="co">#| fig.height: 3</span></span>
<span id="cb36-404"><a href="#cb36-404"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb36-405"><a href="#cb36-405"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(notes, <span class="st">"trios"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(notes, <span class="st">"masterplate"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-406"><a href="#cb36-406"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-407"><a href="#cb36-407"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-408"><a href="#cb36-408"></a>  <span class="fu">contam_histogram</span>(<span class="at">trans =</span> <span class="cn">FALSE</span>, <span class="at">x =</span> f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb36-409"><a href="#cb36-409"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species frequency"</span>, <span class="at">y =</span> <span class="st">"Sample count"</span>) <span class="sc">+</span></span>
<span id="cb36-410"><a href="#cb36-410"></a>  <span class="fu">ggtitle</span>(<span class="st">"Frequency distribution of focal species in masterplate trios"</span>)</span>
<span id="cb36-411"><a href="#cb36-411"></a><span class="in">```</span></span>
<span id="cb36-412"><a href="#cb36-412"></a>Frequency distribution of each species in all samples where it **should** occur.</span>
<span id="cb36-413"><a href="#cb36-413"></a>:::</span>
<span id="cb36-414"><a href="#cb36-414"></a></span>
<span id="cb36-415"><a href="#cb36-415"></a><span class="fu">### Quartets</span></span>
<span id="cb36-416"><a href="#cb36-416"></a></span>
<span id="cb36-417"><a href="#cb36-417"></a>One weakness of this contamination-detection approach is that there is no way to tell from this data whether a quartet masterplate is contaminated because every quartet (by definition) is inoculated with all of the 4 species at different frequencies and with different evolutionary histories. See @sec-quartets2 below for more information. However, we can still visualize the composition of those quartets and whether they seem to be close to what we expected to put in.</span>
<span id="cb36-418"><a href="#cb36-418"></a></span>
<span id="cb36-419"><a href="#cb36-419"></a>::: {#fig-09}</span>
<span id="cb36-422"><a href="#cb36-422"></a><span class="in">```{r}</span></span>
<span id="cb36-423"><a href="#cb36-423"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-424"><a href="#cb36-424"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb36-425"><a href="#cb36-425"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span></span>
<span id="cb36-426"><a href="#cb36-426"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(notes, <span class="st">"quartets"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(notes, <span class="st">"masterplate"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-427"><a href="#cb36-427"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold =</span> <span class="fl">0.01</span>, <span class="at">quartet =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb36-428"><a href="#cb36-428"></a>  <span class="fu">ggtitle</span>(<span class="st">"All masterplate quartets"</span>)</span>
<span id="cb36-429"><a href="#cb36-429"></a><span class="in">```</span></span>
<span id="cb36-430"><a href="#cb36-430"></a>Species composition of masterplate quartets.</span>
<span id="cb36-431"><a href="#cb36-431"></a>:::</span>
<span id="cb36-432"><a href="#cb36-432"></a></span>
<span id="cb36-433"><a href="#cb36-433"></a>These look really good and are clearly following the correct pattern/distribution for the quartets.</span>
<span id="cb36-434"><a href="#cb36-434"></a></span>
<span id="cb36-435"><a href="#cb36-435"></a><span class="fu">## Experimental samples</span></span>
<span id="cb36-436"><a href="#cb36-436"></a></span>
<span id="cb36-437"><a href="#cb36-437"></a>We may need to use a higher threshold than 1% (e.g., 3% frequency) because over 3% we can reliably say that a species is present and it is not due to index cross talk.</span>
<span id="cb36-438"><a href="#cb36-438"></a></span>
<span id="cb36-439"><a href="#cb36-439"></a>::: {#fig-10}</span>
<span id="cb36-442"><a href="#cb36-442"></a><span class="in">```{r}</span></span>
<span id="cb36-443"><a href="#cb36-443"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-444"><a href="#cb36-444"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb36-445"><a href="#cb36-445"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb36-446"><a href="#cb36-446"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-447"><a href="#cb36-447"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-448"><a href="#cb36-448"></a>  <span class="fu">filter</span>(f_raw <span class="sc">&gt;</span> <span class="fl">0.03</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb36-449"><a href="#cb36-449"></a>  <span class="fu">contam_histogram</span>(<span class="at">trans=</span><span class="cn">TRUE</span>, <span class="at">x =</span> f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb36-450"><a href="#cb36-450"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species frequency"</span>, <span class="at">y =</span> <span class="st">"Sample count"</span>) <span class="sc">+</span></span>
<span id="cb36-451"><a href="#cb36-451"></a>  <span class="fu">ggtitle</span>(<span class="st">"Frequency distribution of each species exceeding the 3% threshold"</span>)</span>
<span id="cb36-452"><a href="#cb36-452"></a><span class="in">```</span></span>
<span id="cb36-453"><a href="#cb36-453"></a>Frequency distribution of each species in experimental samples where it **should not** occur and where it exceeds a 3% threshold.</span>
<span id="cb36-454"><a href="#cb36-454"></a>:::</span>
<span id="cb36-455"><a href="#cb36-455"></a></span>
<span id="cb36-458"><a href="#cb36-458"></a><span class="in">```{r}</span></span>
<span id="cb36-459"><a href="#cb36-459"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb36-460"><a href="#cb36-460"></a>  <span class="co"># there are only experiment samples left</span></span>
<span id="cb36-461"><a href="#cb36-461"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-462"><a href="#cb36-462"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-463"><a href="#cb36-463"></a>  <span class="fu">filter</span>(f_raw_targetsp <span class="sc">&gt;</span> <span class="fl">0.03</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb36-464"><a href="#cb36-464"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, strainID, f_raw_targetsp) <span class="sc">%&gt;%</span> </span>
<span id="cb36-465"><a href="#cb36-465"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(f_raw_targetsp))</span>
<span id="cb36-466"><a href="#cb36-466"></a><span class="in">```</span></span>
<span id="cb36-467"><a href="#cb36-467"></a></span>
<span id="cb36-470"><a href="#cb36-470"></a><span class="in">```{r}</span></span>
<span id="cb36-471"><a href="#cb36-471"></a><span class="co">#| eval: true</span></span>
<span id="cb36-472"><a href="#cb36-472"></a><span class="co">#| echo: false</span></span>
<span id="cb36-473"><a href="#cb36-473"></a><span class="co">#| output: false</span></span>
<span id="cb36-474"><a href="#cb36-474"></a>myfilter <span class="ot">&lt;-</span> <span class="cf">function</span>(.data, myexpresion){</span>
<span id="cb36-475"><a href="#cb36-475"></a>  .data <span class="sc">%&gt;%</span> </span>
<span id="cb36-476"><a href="#cb36-476"></a>    <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-477"><a href="#cb36-477"></a>    <span class="fu">filter</span>(<span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-478"><a href="#cb36-478"></a>    <span class="fu">filter</span>( {{ myexpresion }} ) <span class="sc">%&gt;%</span> </span>
<span id="cb36-479"><a href="#cb36-479"></a>    <span class="fu">distinct</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb36-480"><a href="#cb36-480"></a>    <span class="fu">nrow</span>()</span>
<span id="cb36-481"><a href="#cb36-481"></a>}</span>
<span id="cb36-482"><a href="#cb36-482"></a></span>
<span id="cb36-483"><a href="#cb36-483"></a>thresh <span class="ot">&lt;-</span> <span class="fl">0.08</span></span>
<span id="cb36-484"><a href="#cb36-484"></a>totsamp <span class="ot">&lt;-</span> <span class="fu">nrow</span>(<span class="fu">distinct</span>(finaltable_exp_mstr, sample))</span>
<span id="cb36-485"><a href="#cb36-485"></a>contamsamp <span class="ot">&lt;-</span> <span class="fu">myfilter</span>(finaltable_exp_mstr, f_raw_targetsp <span class="sc">&gt;=</span> <span class="fl">0.03</span>)</span>
<span id="cb36-486"><a href="#cb36-486"></a>contamsamp_lo <span class="ot">&lt;-</span> <span class="fu">myfilter</span>(finaltable_exp_mstr, f_raw_targetsp <span class="sc">&gt;=</span> <span class="fl">0.03</span> <span class="sc">&amp;</span> f_raw_targetsp <span class="sc">&lt;</span> thresh)</span>
<span id="cb36-487"><a href="#cb36-487"></a>contamsamp_hi <span class="ot">&lt;-</span> <span class="fu">myfilter</span>(finaltable_exp_mstr, f_raw_targetsp <span class="sc">&gt;=</span> thresh)</span>
<span id="cb36-488"><a href="#cb36-488"></a><span class="in">```</span></span>
<span id="cb36-489"><a href="#cb36-489"></a></span>
<span id="cb36-490"><a href="#cb36-490"></a>There are <span class="in">`{r} contamsamp`</span> samples (<span class="in">`{r} round(contamsamp/totsamp*100)`</span>% of <span class="in">`{r} totsamp`</span> samples) that exceed a 3% crosstalk threshold. <span class="in">`{r} contamsamp_lo`</span> samples (<span class="in">`{r} round(contamsamp_lo/totsamp*100)`</span>% of <span class="in">`{r} totsamp`</span> samples) have contamination &lt;= <span class="in">`{r} thresh*100`</span>% and <span class="in">`{r} contamsamp_hi`</span> samples (<span class="in">`{r} round(contamsamp_hi/totsamp*100)`</span> % of <span class="in">`{r} totsamp`</span> samples) have &gt; <span class="in">`{r} thresh*100`</span>% of a species that should not be there. In most cases the species in highly contaminated samples is HAMBI_1977. I think these <span class="in">`{r} contamsamp_hi`</span> samples are probably at very high risk for legitimate contamination. It is likely that the rest of the <span class="in">`{r} contamsamp_lo`</span> samples with &lt;= <span class="in">`{r} thresh*100`</span>%  contamination are not contaminated but just crosstalk outliers.</span>
<span id="cb36-491"><a href="#cb36-491"></a></span>
<span id="cb36-492"><a href="#cb36-492"></a><span class="fu">### Pairs</span></span>
<span id="cb36-493"><a href="#cb36-493"></a></span>
<span id="cb36-494"><a href="#cb36-494"></a>Here just taking a closer look at the pairs from the experiment that appear to be contaminated.</span>
<span id="cb36-495"><a href="#cb36-495"></a></span>
<span id="cb36-496"><a href="#cb36-496"></a>::: {#fig-11}</span>
<span id="cb36-499"><a href="#cb36-499"></a><span class="in">```{r}</span></span>
<span id="cb36-500"><a href="#cb36-500"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-501"><a href="#cb36-501"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb36-502"><a href="#cb36-502"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb36-503"><a href="#cb36-503"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>) <span class="sc">&amp;</span> n_species <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-504"><a href="#cb36-504"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold =</span> <span class="fl">0.03</span>, <span class="at">quartet =</span> <span class="cn">FALSE</span>, <span class="at">y=</span>f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb36-505"><a href="#cb36-505"></a>  <span class="fu">ggtitle</span>(<span class="st">"Experiment pairs with &gt; 3% contamination"</span>)</span>
<span id="cb36-506"><a href="#cb36-506"></a><span class="in">```</span></span>
<span id="cb36-507"><a href="#cb36-507"></a>Species composition of pairs masterplates samples that contain &gt; 3% of a species that shouldn’t be there (shown in grey to black). </span>
<span id="cb36-508"><a href="#cb36-508"></a>:::</span>
<span id="cb36-509"><a href="#cb36-509"></a></span>
<span id="cb36-510"><a href="#cb36-510"></a>All experimental pair samples look pretty good. I think we should only exclude samples where the contamination is very high (over ~50% of the sample) but those with around 10% or less contaminant I think can be retained. So we will not need filter any of these out. </span>
<span id="cb36-511"><a href="#cb36-511"></a></span>
<span id="cb36-512"><a href="#cb36-512"></a><span class="fu">### Trios</span></span>
<span id="cb36-513"><a href="#cb36-513"></a></span>
<span id="cb36-514"><a href="#cb36-514"></a>Here just taking a closer look at the trios from the experiment that appear to be contaminated.</span>
<span id="cb36-515"><a href="#cb36-515"></a></span>
<span id="cb36-516"><a href="#cb36-516"></a>::: {#fig-12}</span>
<span id="cb36-519"><a href="#cb36-519"></a><span class="in">```{r}</span></span>
<span id="cb36-520"><a href="#cb36-520"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb36-521"><a href="#cb36-521"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb36-522"><a href="#cb36-522"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb36-523"><a href="#cb36-523"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>) <span class="sc">&amp;</span> n_species <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-524"><a href="#cb36-524"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold=</span><span class="fl">0.03</span>, <span class="at">quartet =</span> <span class="cn">FALSE</span>, <span class="at">y=</span>f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb36-525"><a href="#cb36-525"></a>  <span class="fu">ggtitle</span>(<span class="st">"Experiment trios with &gt; 3% contamination"</span>)</span>
<span id="cb36-526"><a href="#cb36-526"></a><span class="in">```</span></span>
<span id="cb36-527"><a href="#cb36-527"></a>Species composition of experiment trio samples that contain &gt; 3% of a species that shouldn’t be there (shown in grey to black). </span>
<span id="cb36-528"><a href="#cb36-528"></a>:::</span>
<span id="cb36-529"><a href="#cb36-529"></a></span>
<span id="cb36-530"><a href="#cb36-530"></a>Only 2 trio samples look really bad (over 10 %, more like 50 % contamination). Again, I think we should only exclude samples where the contamination is very high (over ~50% of the sample) but those with around 10% or less contaminant I think can be retained, and I will discard the contaminating sequences.</span>
<span id="cb36-531"><a href="#cb36-531"></a></span>
<span id="cb36-534"><a href="#cb36-534"></a><span class="in">```{r}</span></span>
<span id="cb36-535"><a href="#cb36-535"></a>contamtrios <span class="ot">&lt;-</span> finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb36-536"><a href="#cb36-536"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>) <span class="sc">&amp;</span> n_species <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-537"><a href="#cb36-537"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-538"><a href="#cb36-538"></a>  <span class="fu">filter</span>(f_raw_targetsp <span class="sc">&gt;</span> <span class="fl">0.13</span>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb36-539"><a href="#cb36-539"></a>  <span class="fu">pull</span>(sample)</span>
<span id="cb36-540"><a href="#cb36-540"></a><span class="in">```</span></span>
<span id="cb36-541"><a href="#cb36-541"></a></span>
<span id="cb36-542"><a href="#cb36-542"></a><span class="fu">### Quartets {#sec-quartets2}</span></span>
<span id="cb36-543"><a href="#cb36-543"></a></span>
<span id="cb36-544"><a href="#cb36-544"></a>Again, one weakness of this approach is that there is no way to tell from this data whether a quartet is contaminated because every quartet (by definition) is inoculated with all of the 4 species at different frequencies and with different evolutionary histories. Thus we would expect to see either all 4 species present or a subset of the 4 species in the quartet samples, but we cannot tell if these patterns come from contamination or not. Moving forward we just have to assume that the quartets are OK... However, we've found so little contamination in our other experimental samples and all samples were handled in the experiment and processed for sequence library preparation in the same way. I think it is safe to assume that contamination in the quartets is minimal issue. </span>
<span id="cb36-545"><a href="#cb36-545"></a></span>
<span id="cb36-546"><a href="#cb36-546"></a>::: {#fig-13}</span>
<span id="cb36-549"><a href="#cb36-549"></a><span class="in">```{r}</span></span>
<span id="cb36-550"><a href="#cb36-550"></a><span class="co">#| fig.width: 10</span></span>
<span id="cb36-551"><a href="#cb36-551"></a><span class="co">#| fig.height: 12</span></span>
<span id="cb36-552"><a href="#cb36-552"></a>finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb36-553"><a href="#cb36-553"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(community_type, <span class="st">"experiment"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-554"><a href="#cb36-554"></a>  <span class="fu">filter</span>(n_species <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-555"><a href="#cb36-555"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb36-556"><a href="#cb36-556"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb36-557"><a href="#cb36-557"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-558"><a href="#cb36-558"></a>  <span class="fu">mutate</span>(<span class="at">facet =</span> <span class="fu">ntile</span>(id, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-559"><a href="#cb36-559"></a>  <span class="fu">contaminated_barplot</span>(<span class="at">threshold =</span> <span class="dv">0</span>, <span class="at">quartet =</span> <span class="cn">TRUE</span>, <span class="at">y=</span>f_raw_targetsp) <span class="sc">+</span></span>
<span id="cb36-560"><a href="#cb36-560"></a>  <span class="fu">ggtitle</span>(<span class="st">"All experimental quartets"</span>) <span class="sc">+</span></span>
<span id="cb36-561"><a href="#cb36-561"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>facet, <span class="at">scales=</span><span class="st">"free_x"</span>, <span class="at">nrow=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb36-562"><a href="#cb36-562"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-563"><a href="#cb36-563"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-564"><a href="#cb36-564"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-565"><a href="#cb36-565"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb36-566"><a href="#cb36-566"></a>    )</span>
<span id="cb36-567"><a href="#cb36-567"></a><span class="in">```</span></span>
<span id="cb36-568"><a href="#cb36-568"></a>Species composition of masterplate quartets.</span>
<span id="cb36-569"><a href="#cb36-569"></a>:::</span>
<span id="cb36-570"><a href="#cb36-570"></a></span>
<span id="cb36-571"><a href="#cb36-571"></a><span class="fu"># Export</span></span>
<span id="cb36-572"><a href="#cb36-572"></a></span>
<span id="cb36-575"><a href="#cb36-575"></a><span class="in">```{r}</span></span>
<span id="cb36-576"><a href="#cb36-576"></a>finaltable_exp_mstr_export <span class="ot">&lt;-</span> finaltable_exp_mstr <span class="sc">%&gt;%</span> </span>
<span id="cb36-577"><a href="#cb36-577"></a>  <span class="co"># first remove samples with low read count (&lt; 3000 reads)</span></span>
<span id="cb36-578"><a href="#cb36-578"></a>  <span class="co"># filter(sample %nin% lowread_samps) %&gt;% </span></span>
<span id="cb36-579"><a href="#cb36-579"></a>  <span class="co"># next remove masterplate pair samples that were highly contaminated</span></span>
<span id="cb36-580"><a href="#cb36-580"></a>  <span class="co"># filter(sample %nin% contampairsmaster) %&gt;% </span></span>
<span id="cb36-581"><a href="#cb36-581"></a>  <span class="co"># remove trio samples that were highly contaminated</span></span>
<span id="cb36-582"><a href="#cb36-582"></a>  <span class="fu">filter</span>(sample <span class="sc">%nin%</span> contamtrios) <span class="sc">%&gt;%</span> </span>
<span id="cb36-583"><a href="#cb36-583"></a>  <span class="co"># exclude any remaining counts from species that shouldnt be there using again</span></span>
<span id="cb36-584"><a href="#cb36-584"></a>  <span class="co"># the fact that evo_hist should be NA for these species</span></span>
<span id="cb36-585"><a href="#cb36-585"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(evo_hist)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-586"><a href="#cb36-586"></a>  <span class="co"># because we set 3% as our limit of detection we set read counts of species</span></span>
<span id="cb36-587"><a href="#cb36-587"></a>  <span class="co"># less than 1% to 0</span></span>
<span id="cb36-588"><a href="#cb36-588"></a>  <span class="fu">mutate</span>(<span class="at">count_correct_thresh =</span> <span class="fu">if_else</span>(f_raw_targetsp <span class="sc">&lt;=</span> <span class="fl">0.03</span>, <span class="dv">0</span>, count_correct)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-589"><a href="#cb36-589"></a>  <span class="co"># now calculate a new relative abundance based only on the species that should</span></span>
<span id="cb36-590"><a href="#cb36-590"></a>  <span class="co"># be present and that are &gt; 3% relative abundance</span></span>
<span id="cb36-591"><a href="#cb36-591"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb36-592"><a href="#cb36-592"></a>  <span class="fu">mutate</span>(<span class="at">f_thresh =</span> count_correct_thresh<span class="sc">/</span><span class="fu">sum</span>(count_correct_thresh)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-593"><a href="#cb36-593"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-594"><a href="#cb36-594"></a>  <span class="co"># for marking which sequencing batch these came from </span></span>
<span id="cb36-595"><a href="#cb36-595"></a>  <span class="fu">mutate</span>(<span class="at">batch =</span> <span class="st">"run202410124"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-596"><a href="#cb36-596"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, strainID, evo_hist, count_correct_thresh, f_thresh,</span>
<span id="cb36-597"><a href="#cb36-597"></a>                <span class="at">target_f_masterplate =</span> target_f, replicate, strep_conc, </span>
<span id="cb36-598"><a href="#cb36-598"></a>                transfers, n_species, community_type, plate_well, batch)</span>
<span id="cb36-599"><a href="#cb36-599"></a><span class="in">```</span></span>
<span id="cb36-600"><a href="#cb36-600"></a></span>
<span id="cb36-601"><a href="#cb36-601"></a><span class="fu">## Pairs</span></span>
<span id="cb36-602"><a href="#cb36-602"></a></span>
<span id="cb36-603"><a href="#cb36-603"></a>Write the pair samples</span>
<span id="cb36-604"><a href="#cb36-604"></a></span>
<span id="cb36-607"><a href="#cb36-607"></a><span class="in">```{r}</span></span>
<span id="cb36-608"><a href="#cb36-608"></a>finaltable_exp_mstr_export <span class="sc">%&gt;%</span> </span>
<span id="cb36-609"><a href="#cb36-609"></a>  <span class="fu">filter</span>(n_species <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-610"><a href="#cb36-610"></a>  <span class="fu">arrange</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb36-611"><a href="#cb36-611"></a>  <span class="fu">write_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"pairs_counts.tsv"</span>))</span>
<span id="cb36-612"><a href="#cb36-612"></a><span class="in">```</span></span>
<span id="cb36-613"><a href="#cb36-613"></a></span>
<span id="cb36-614"><a href="#cb36-614"></a><span class="fu">## Trios</span></span>
<span id="cb36-615"><a href="#cb36-615"></a></span>
<span id="cb36-616"><a href="#cb36-616"></a>Write the trio samples</span>
<span id="cb36-617"><a href="#cb36-617"></a></span>
<span id="cb36-620"><a href="#cb36-620"></a><span class="in">```{r}</span></span>
<span id="cb36-621"><a href="#cb36-621"></a>finaltable_exp_mstr_export <span class="sc">%&gt;%</span> </span>
<span id="cb36-622"><a href="#cb36-622"></a>  <span class="fu">filter</span>(n_species <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-623"><a href="#cb36-623"></a>  <span class="fu">arrange</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb36-624"><a href="#cb36-624"></a>  <span class="fu">write_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"trios_counts.tsv"</span>))</span>
<span id="cb36-625"><a href="#cb36-625"></a><span class="in">```</span></span>
<span id="cb36-626"><a href="#cb36-626"></a></span>
<span id="cb36-627"><a href="#cb36-627"></a><span class="fu">## Quartets</span></span>
<span id="cb36-628"><a href="#cb36-628"></a></span>
<span id="cb36-629"><a href="#cb36-629"></a>Write the quartet samples</span>
<span id="cb36-630"><a href="#cb36-630"></a></span>
<span id="cb36-633"><a href="#cb36-633"></a><span class="in">```{r}</span></span>
<span id="cb36-634"><a href="#cb36-634"></a>finaltable_exp_mstr_export <span class="sc">%&gt;%</span> </span>
<span id="cb36-635"><a href="#cb36-635"></a>  <span class="fu">filter</span>(n_species <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-636"><a href="#cb36-636"></a>  <span class="fu">arrange</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb36-637"><a href="#cb36-637"></a>  <span class="fu">write_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"quartets_counts.tsv"</span>))</span>
<span id="cb36-638"><a href="#cb36-638"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>